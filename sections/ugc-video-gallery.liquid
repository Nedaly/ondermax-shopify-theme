<div class="ugc-video-gallery padding-{{ section.id }}" id="ugc-gallery">
    <div class="page-width">
        <div class="heading">
            {%- if section.settings.show_badge -%}
                <div class="ugc_badge">
                    <span class="badge badge--{{ section.settings.badge_style }} {{ section.settings.badge_size }}">
                        {{ section.settings.badge_text | default: 'Real Results' }}
                    </span>
                </div>
            {%- endif -%}
            <h2 class="ugc_heading">{{ section.settings.heading }}</h2>
            <p class="ugc_subheading">{{ section.settings.subheading }}</p>
        </div>
        
        <div class="ugc_video_grid">
            {% for block in section.blocks %}
                <div class="ugc_video_item" data-aos="fade-up" data-aos-delay="{{ forloop.index0 | times: 100 }}">
                    <div class="video_container">
                        {%- if block.settings.video_url.type == 'youtube' -%}
                            <iframe
                                src="https://www.youtube.com/embed/{{ block.settings.video_url.id }}?enablejsapi=1&autoplay=0&mute=1&controls=1&showinfo=0&rel=0"
                                class="ugc_video"
                                allow="autoplay; encrypted-media"
                                allowfullscreen
                                title="{{ block.settings.customer_name | escape }} - {{ block.settings.description | escape }}"
                                loading="lazy"
                            ></iframe>
                        {%- elsif block.settings.video_url.type == 'vimeo' -%}
                            <iframe
                                src="https://player.vimeo.com/video/{{ block.settings.video_url.id }}?autoplay=0&muted=1&controls=1&title=0&byline=0&portrait=0"
                                class="ugc_video"
                                allow="autoplay; encrypted-media"
                                allowfullscreen
                                title="{{ block.settings.customer_name | escape }} - {{ block.settings.description | escape }}"
                                loading="lazy"
                            ></iframe>
                        {%- elsif block.settings.video_file != blank -%}
                            <video 
                                class="ugc_video" 
                                controls 
                                muted 
                                preload="metadata"
                                poster="{{ block.settings.thumbnail | image_url: width: 400 }}"
                            >
                                <source src="{{ block.settings.video_file }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        {%- endif -%}
                        
                        <div class="video_overlay">
                            <div class="play_button">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="5,3 19,12 5,21"></polygon>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="video_info">
                        <div class="customer_info">
                            {%- if block.settings.customer_avatar != blank -%}
                                <img src="{{ block.settings.customer_avatar | image_url: width: 40 }}" alt="{{ block.settings.customer_name }}" class="customer_avatar">
                            {%- endif -%}
                            <div class="customer_details">
                                <h4 class="customer_name">{{ block.settings.customer_name }}</h4>
                                <p class="customer_role">{{ block.settings.customer_role }}</p>
                            </div>
                        </div>
                        <p class="video_description">{{ block.settings.description }}</p>
                        {%- if block.settings.show_rating -%}
                            <div class="video_rating">
                                {%- for i in (1..5) -%}
                                    <span class="star {% if i <= block.settings.rating %}filled{% endif %}">â˜…</span>
                                {%- endfor -%}
                            </div>
                        {%- endif -%}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
    .padding-{{ section.id }}{
        padding-top:{{ section.settings.p_top | times: 0.75 | round: 0 }}px;
        padding-bottom:{{ section.settings.p_bottom | times: 0.75 | round: 0 }}px;
    }

    .ugc-video-gallery {
        background: {{ section.settings.bg_color }};
    }

    .ugc_heading {
        text-align: center;
        font-family: "Poppins", sans-serif;
        font-size: 48px;
        font-weight: 600;
        letter-spacing: -1.5px;
        color: #fff;
        margin: 0;
        line-height: 1.1;
        text-transform: capitalize;
    }

    .ugc_subheading {
        color: #cfcfcf;
        font-family: 'Poppins';
        font-size: 20px;
        text-align: center;
        letter-spacing: 0;
        margin: 0 auto;
        line-height: 1.6;
        max-width: 60%;
        margin-block: 2rem;
    }

    .ugc_badge {
        text-align: center;
        margin-bottom: 20px;
    }

    .ugc_video_grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 3rem;
    }

    .ugc_video_item {
        background: #262626;
        border: 1px solid #303030;
        border-radius: 1rem;
        overflow: hidden;
        transition: all 0.3s ease-in-out;
        position: relative;
    }

    .ugc_video_item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 144, 141, 0.2);
        border-color: #00908d;
    }

    .video_container {
        position: relative;
        width: 100%;
        height: 200px;
        overflow: hidden;
        border-radius: 1rem 1rem 0 0;
    }

    .ugc_video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border: none;
    }

    .video_overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        transition: opacity 0.3s ease;
    }

    .ugc_video_item:hover .video_overlay {
        opacity: 0;
    }

    .play_button {
        width: 60px;
        height: 60px;
        background: rgba(0, 144, 141, 0.9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        transition: all 0.3s ease;
    }

    .play_button:hover {
        background: #00908d;
        transform: scale(1.1);
    }

    .video_info {
        padding: 1.5rem;
    }

    .customer_info {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .customer_avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
    }

    .customer_name {
        font-family: 'Poppins', sans-serif;
        font-size: 16px;
        font-weight: 600;
        color: #fff;
        margin: 0;
    }

    .customer_role {
        font-family: 'Poppins', sans-serif;
        font-size: 12px;
        color: #cfcfcf;
        margin: 0;
    }

    .video_description {
        font-family: 'Poppins', sans-serif;
        font-size: 14px;
        color: #cfcfcf;
        line-height: 1.5;
        margin: 0 0 1rem 0;
    }

    .video_rating {
        display: flex;
        gap: 2px;
    }

    .star {
        color: #ddd;
        font-size: 16px;
    }

    .star.filled {
        color: #ffd700;
    }

    /* Mobile-first responsive design */
    @media screen and (max-width: 768px) {
        .ugc_heading {
            font-size: 32px;
            letter-spacing: -0.5px;
        }

        .ugc_subheading {
            font-size: 16px;
            max-width: 100%;
        }

        .ugc_video_grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .video_container {
            height: 180px;
        }

        .video_info {
            padding: 1rem;
        }

        .customer_info {
            gap: 0.75rem;
        }

        .customer_avatar {
            width: 32px;
            height: 32px;
        }

        .customer_name {
            font-size: 14px;
        }

        .customer_role {
            font-size: 11px;
        }

        .video_description {
            font-size: 13px;
        }
    }

    @media screen and (min-width: 750px) {
        .padding-{{ section.id }}{
            padding-top:{{ section.settings.p_top }}px;
            padding-bottom:{{ section.settings.p_bottom }}px;
        }
    }
</style>

{% schema %}
{
    "name": "UGC Video Gallery",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Real Results from Real People"
        },
        {
            "type": "text",
            "id": "subheading",
            "label": "Subheading",
            "default": "See how SURGE is transforming lives every day"
        },
        {
            "type": "color",
            "id": "bg_color",
            "label": "Background color",
            "default": "#1a1a1a"
        },
        {
            "type": "header",
            "content": "CRO Enhancements"
        },
        {
            "type": "checkbox",
            "id": "show_badge",
            "label": "Show badge",
            "default": true
        },
        {
            "type": "text",
            "id": "badge_text",
            "label": "Badge text",
            "default": "Real Results"
        },
        {
            "type": "select",
            "id": "badge_style",
            "label": "Badge style",
            "options": [
                {"value": "primary", "label": "Primary"},
                {"value": "secondary", "label": "Secondary"},
                {"value": "success", "label": "Success"},
                {"value": "warning", "label": "Warning"}
            ],
            "default": "primary"
        },
        {
            "type": "select",
            "id": "badge_size",
            "label": "Badge size",
            "options": [
                {"value": "badge--small", "label": "Small"},
                {"value": "badge--medium", "label": "Medium"},
                {"value": "badge--large", "label": "Large"}
            ],
            "default": "badge--medium"
        },
        {
            "type": "header",
            "content": "Layout"
        },
        {
            "type": "range",
            "id": "p_top",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "default": 80,
            "label": "Padding top"
        },
        {
            "type": "range",
            "id": "p_bottom",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "px",
            "default": 80,
            "label": "Padding bottom"
        }
    ],
    "blocks": [
        {
            "type": "ugc_video",
            "name": "UGC Video",
            "settings": [
                {
                    "type": "video_url",
                    "id": "video_url",
                    "label": "Video URL",
                    "accept": ["youtube", "vimeo"]
                },
                {
                    "type": "url",
                    "id": "video_file",
                    "label": "Video File URL",
                    "info": "Direct URL to MP4 file as alternative to video URL"
                },
                {
                    "type": "image_picker",
                    "id": "thumbnail",
                    "label": "Video Thumbnail",
                    "info": "Optional thumbnail for video file"
                },
                {
                    "type": "header",
                    "content": "Customer Info"
                },
                {
                    "type": "image_picker",
                    "id": "customer_avatar",
                    "label": "Customer Avatar"
                },
                {
                    "type": "text",
                    "id": "customer_name",
                    "label": "Customer Name",
                    "default": "Sarah M."
                },
                {
                    "type": "text",
                    "id": "customer_role",
                    "label": "Customer Role",
                    "default": "Marketing Manager"
                },
                {
                    "type": "textarea",
                    "id": "description",
                    "label": "Video Description",
                    "default": "SURGE has completely changed my energy levels!"
                },
                {
                    "type": "checkbox",
                    "id": "show_rating",
                    "label": "Show rating",
                    "default": true
                },
                {
                    "type": "range",
                    "id": "rating",
                    "min": 1,
                    "max": 5,
                    "step": 1,
                    "default": 5,
                    "label": "Rating"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "UGC Video Gallery"
        }
    ]
}
{% endschema %}
