<div id="shopify-section-template--17653238890663__card_slider_Lk6Tfj" class="shopify-section card-slider-section">
  

  <style>
@media screen and (min-width: 1200px) {
    .card-slider {
        padding: 100px 0;
        padding-bottom: 0!important;
    }
}

.card-slider__grid-item .button {
   
    border-radius: 0px!important;
      font-size: 20px;
      padding: 20px;
  }


@media screen and (max-width: 768px) {
.card-slider__grid {
    display: block !important;
   
}


.card-slider {
   
    padding-bottom: 0px !important;
}
}

.card-slider__card-image.class-2{
 background: linear-gradient(254.87deg, #282340 -1.38%, #685BA6 109.67%);
}
.card-slider__card-image.class-1{
background: linear-gradient(117.85deg, #073F3F 24.07%, #1A8787 109.64%);
}

    .card-slider{padding:60px 0;overflow:visible}.card-slider__inner{max-width:1400px;margin:0 auto;padding:0}.card-slider__header-container{display:flex;flex-direction:column;align-items:center}.card-slider__header{text-align:center;max-width:95%}.card-slider__heading{font-size:28px;line-height:1.2;margin-bottom:15px;margin-top:0;text-transform:uppercase}.card-slider__heading-regular{font-weight:400}.card-slider__heading-italic{font-weight:400;font-style:italic}.card-slider__subheading{font-size:16px;font-family:ABC Arizona Flare,sans-serif;font-weight:400;margin-bottom:12px}.card-slider__description{max-width:95%;margin:0 auto 25px;font-size:14px;}.card-slider__container{position:relative;margin:0 auto;width:100%;max-width:100%;padding:0;overflow-x:visible}.card-slider__grid{display:grid;gap:20px;padding:40px 20px;max-width:100%;overflow:visible;transition:max-height .7s ease-in-out;grid-template-columns:repeat(1,1fr)}.card-slider__grid.collapsed,.card-slider__grid.expanded{padding-top:40px;padding-bottom:60px}.card-slider__grid-item{display:flex;flex-direction:column;perspective:1000px;transform-style:preserve-3d;z-index:1;transition:z-index .01s .6s;margin-bottom:10px}@media (hover: hover){.card-slider__grid-item:hover{z-index:1;transition:z-index .01s}}.card-slider__card{position:relative;width:100%;height:450px;transition:transform .54s cubic-bezier(.22,1,.36,1),box-shadow .32s ease;transform-style:preserve-3d;border-radius:8px;box-shadow:0 4px 12px #00000026;will-change:transform;transform-origin:center center}@media (hover: hover){.card-slider__card:hover{box-shadow:0 8px 22px #0000002e}}.card-slider__card.flipped{transform:rotateY(180deg)}.card-slider__card-front,.card-slider__card-back{position:absolute;width:100%;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;border-radius:8px;cursor:pointer;transition:opacity .36s ease-in-out;overflow:hidden;will-change:transform,opacity}@media not all and (min-resolution:.001dpcm){@supports (-webkit-appearance:none){.card-slider__card.flipped .card-slider__card-front{visibility:hidden}.card-slider__card:not(.flipped) .card-slider__card-back{visibility:hidden}}}.card-slider__card-front{display:flex;flex-direction:column;justify-content:center}.card-slider__card-back{transform:rotateY(180deg);background-color:#f8f8f8;padding:20px;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;border-radius:8px}.card-slider__card .card-slider__card-front{pointer-events:auto}.card-slider__card .card-slider__card-back,.card-slider__card.flipped .card-slider__card-front{pointer-events:none}.card-slider__card.flipped .card-slider__card-back{pointer-events:auto}.card-slider__card-image{overflow:hidden;pointer-events:none;text-align: center;margin: 0 auto;width: 100%;padding: 20px;}.card-slider__card-image img{width:auto;height:100% !important;transition:transform .3s ease;border-radius:0;pointer-events:none}.card-slider__card-image--radius-0 img{border-radius:0}.card-slider__card-image--radius-sm img{border-radius:4px}.card-slider__card-image--radius-md img{border-radius:8px}.card-slider__card-image--radius-lg img{border-radius:16px}.card-slider__card-image--radius-circle img{border-radius:50%}.card-slider__card-image--cover-mobile img{object-fit:cover}.card-slider__card-image--contain-mobile img{object-fit:contain}.card-slider__card-image--fill-mobile img{object-fit:fill}.card-slider__card-image--scale-down-mobile img{object-fit:scale-down}.card-slider__card-image--none-mobile img{object-fit:none}@media (hover: hover){.card-slider__card:hover .card-slider__card-image img{transform:scale(1.05)}}.card-slider__card-content{padding:15px;background-color:#fff;flex-grow:1;display:flex;flex-direction:column;justify-content:center;align-items:center}.card-slider__card-title{font-size:15px;margin:0 0 10px;font-weight:600;text-align:center;line-height:150%}.card-slider__card-description{font-size:14px;line-height:120%;text-align:center}.card-slider__card-description p{margin:0}.card-slider__card-back-content{font-size:14px;margin-top:20px;opacity:0;transform:translateY(8px);transition:opacity .3s ease,transform .4s cubic-bezier(.22,1,.36,1);}.card-slider__card.flipped .card-slider__card-back-content{opacity:1;transform:translateY(0);transition-delay:.12s}.card-slider__flip-icon{position:absolute;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;backface-visibility:hidden;-webkit-backface-visibility:hidden;z-index:2;pointer-events:none}.card-slider__flip-icon img{pointer-events:none}.card-slider__flip-icon-front{top:10px;right:10px;transform:rotateY(0)}.card-slider__flip-icon-back{top:10px;left:10px;transform:rotateY(180deg)}@media screen and (min-width: 480px){.card-slider__heading{font-size:32px}.card-slider__subheading{font-size:18px}.card-slider__description{font-size:15px}.card-slider__grid{padding:0 20px}.card-slider__card-content{padding:18px}}@media screen and (min-width: 768px){.card-slider{padding:80px 0}.card-slider__header{max-width:85%}.card-slider__heading{font-size:36px}.card-slider__subheading{font-size:20px;margin-bottom:15px}.card-slider__description{max-width:80%;font-size:16px}.card-slider__grid{overflow-y:hidden;overflow-x:visible;grid-template-columns:repeat(2,1fr);gap:25px;padding:40px 25px 60px}.card-slider__card{height:500px}.card-slider__card-image{height:160px}.card-slider__card-content{padding:20px}.card-slider__card-title{font-size:17px;margin-bottom:12px}.card-slider__card-description{font-size:15px}.card-slider__card-image--cover-desktop img{object-fit:cover}.card-slider__card-image--contain-desktop img{object-fit:contain}.card-slider__card-image--fill-desktop img{object-fit:fill}.card-slider__card-image--scale-down-desktop img{object-fit:scale-down}.card-slider__card-image--none-desktop img{object-fit:none}}@media screen and (min-width: 992px){.card-slider__header{max-width:800px}.card-slider__heading{font-size:42px}.card-slider__grid{gap:30px}.card-slider__description{max-width:700px}}@media screen and (min-width: 1024px){.card-slider__grid{grid-template-columns:repeat(4,1fr);gap:30px;padding:40px 30px 60px}}@media (prefers-reduced-motion: reduce){.card-slider__card{transition:none}.card-slider__card:hover{box-shadow:0 4px 12px #00000026}.card-slider__card-back-content{transition:none;transform:none;opacity:1}}@media screen and (min-width: 1200px){.card-slider{padding:100px 0}.card-slider__header{max-width:800px}.card-slider__subheading{font-size:24px}.card-slider__description{max-width:800px;margin:0 auto 30px}}@media screen and (max-width: 767px){.card-slider__card .card-slider__card-front{opacity:1;pointer-events:auto}.card-slider__card .card-slider__card-back,.card-slider__card.flipped .card-slider__card-front{opacity:0;pointer-events:none}.card-slider__card.flipped .card-slider__card-back{opacity:1;pointer-events:auto}.card-slider__view-all-container{display:none!important}.card-slider__container{padding-left:0!important;padding-right:0!important}.card-slider__grid{position:relative;width:100vw;left:50%;transform:translate(-50%);box-sizing:border-box;grid-auto-flow:column;grid-auto-columns:280px;grid-template-columns:none;gap:15px;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory;scroll-padding-left:40px;scroll-padding-right:40px;padding:10px 15px 20px;max-height:none!important;transition:none}.card-slider__grid.collapsed,.card-slider__grid.expanded{max-height:none!important;padding-top:10px;padding-bottom:20px}.card-slider__grid-item{scroll-snap-align:start}}.card-slider__view-all-container{text-align:center;margin-top:30px;margin-bottom:20px}.card-slider__view-all-button{appearance:none;-webkit-appearance:none;background-color:#a40011;color:#fff;border:none;padding:5px 10px;font-size:14px;font-weight:700;text-transform:uppercase;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center;text-decoration:none;max-width:300px}.card-slider__view-all-button:active,.card-slider__view-all-button:focus:not(:hover){background-color:#a40011;color:#fff}.card-slider__view-all-button:active{transform:translateY(0)}.card-slider__header-image-wrapper{margin-bottom:20px}.card-slider__header-image-wrapper img{display:block;margin-left:auto;margin-right:auto;height:auto;border-radius:4px;width:80%;max-width:320px}@media screen and (min-width: 480px){.card-slider__header-image-wrapper img{max-width:300px}}@media screen and (max-width: 480px){.card-slider__subheading{font-size:14px}.card-slider__heading{font-size:26px}}@media screen and (min-width: 768px){.card-slider__header-image-wrapper img{max-width:400px}}
/*# sourceMappingURL=/cdn/shop/t/121/assets/card-slider.css.map?v=9721808424385966131764153949 */
  </style>

<div class="card-slider">
  <div class="card-slider__inner">
    <div class="card-slider__header-container">
    <div class="card-slider__header ">
      
        {% if section.settings.heading_regular or section.settings.heading_italic %}
<h2 class="card-slider__heading page-width">
  <span class="card-slider__heading-regular">{{ section.settings.heading_regular }}</span>
  <span class="card-slider__heading-italic">{{ section.settings.heading_italic }}</span>
</h2>
{% endif %}
      
      
      
        <div class="card-slider__header-image-wrapper">
 {% if section.settings.header_image %}
    <img src="{{ section.settings.header_image | img_url: '800x' }}" 
         alt="{{ section.settings.subheading }}" 
         loading="lazy">
  {% endif %}        </div>
      
      
      
       {% if section.settings.subheading %}
  <div class="card-slider__subheading">
    {{ section.settings.subheading }}
  </div>
{% endif %}
      
      
      
      {% if section.settings.description %}
  <div class="card-slider__description">
    {{ section.settings.description }}
  </div>
{% endif %}
      
      </div>
    </div>
    
    
      <div class="card-slider__container page-width">
        <div class="card-slider__grid collapsed" style="max-height: 750px;">
          
            {% for block in section.blocks %}
    <div class="card-slider__grid-item">
      <div class="card-slider__card">
        <!-- Front -->
        <div class="card-slider__card-front">
        <div class="card-slider__card-image class-{{ forloop.index }}">
            {% if block.settings.front_image %}
              <img src="{{ block.settings.front_image | img_url: '500x' }}" alt="{{ block.settings.title }}" loading="lazy">
            {% endif %}
          </div> 
          {% comment %} <div class="card-slider__flip-icon card-slider__flip-icon-front">
                  <img src="https://cdn.shopify.com/s/files/1/0930/5807/2907/files/svgviewer-output_7.svg?v=1766039167" alt="Flip card" width="34" height="34">
                </div> {% endcomment %}
          <div class="card-slider__card-content">
            <p class="card-slider__card-title">{{ block.settings.title }}</p>
            <div class="card-slider__card-description">{{ block.settings.front_description }}</div>
          </div>
          

           {% if block.settings.button_link != blank %}
  <a href="{{ block.settings.button_link }}" class="button">
    {{ block.settings.button_label }}
  </a>
{% endif %}
        </div>
        <!-- Back -->
        {% comment %} <div class="card-slider__flip-icon card-slider__flip-icon-back">
                  <img src="https://cdn.shopify.com/s/files/1/0930/5807/2907/files/svgviewer-output_7.svg?v=1766039167" alt="Flip card" width="34" height="34">
                </div> {% endcomment %}
        <div class="card-slider__card-back">
          <div class="card-slider__card-back-content">
            {{ block.settings.back_content }}
          </div>

         

        </div>
      </div>
    </div>
  {% endfor %}
          
        </div>
      </div>
    

    
      <div class="card-slider__view-all-container page-width">
        <button type="button" class="card-slider__view-all-button button button--primary">
          <span class="card-slider__view-all-text-expand">View All</span>
          <span class="card-slider__view-all-text-collapse" style="display: none;">View Less</span>
        </button>
      </div>
    
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const cardSliderInner = document.querySelector('.card-slider__inner');
    if (!cardSliderInner) {
      // console.log('Card Slider: Container not found');
      return;
    }

    const cardGrid = cardSliderInner.querySelector('.card-slider__grid');
    const cards = Array.from(cardSliderInner.querySelectorAll('.card-slider__card'));
    const viewAllButton = cardSliderInner.querySelector('.card-slider__view-all-button');
    const viewAllContainer = cardSliderInner.querySelector('.card-slider__view-all-container');
    const viewAllTextExpand = viewAllButton ? viewAllButton.querySelector('.card-slider__view-all-text-expand') : null;
    const viewAllTextCollapse = viewAllButton ? viewAllButton.querySelector('.card-slider__view-all-text-collapse') : null;

    if (!cardGrid || !cards.length) {
      // console.log('Card Slider: No cards or grid found');
      return;
    }

    const hoverTransition = 'transform 120ms ease-out';
    const flipTransition = 'transform 540ms cubic-bezier(0.22, 1, 0.36, 1)';
    let isExpanded = false;
    const desktopColumns = 4; // Corresponds to card-slider__grid--4-col
    const tabletColumns = 2;  // Corresponds to card-slider__grid--2-col
    const mobileColumns = 1;  // Default or card-slider__grid--1-col
    const maxInitialRows = 2;

    // Check if device is mobile (width less than 768px)
    function isMobile() {
      return window.innerWidth < 768; // Match this with your CSS breakpoint for mobile-specific card behavior
    }
    
    // Chrome detection retained but no longer used for 3D tilt
    function isChrome() {
      return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
    }

    function getColumns() {
      const windowWidth = window.innerWidth;
      // These breakpoints should match your CSS for grid column changes
      if (windowWidth >= 1024) return desktopColumns; // Desktop view
      if (windowWidth >= 768) return tabletColumns;   // Tablet view
      return mobileColumns;                           // Mobile view
    }

    function calculateAndApplyGridHeight() {
      if (!cardGrid || !cards.length) return;

      // Don't apply height calculations on mobile
      if (isMobile()) {
        cardGrid.style.maxHeight = '';
        cardGrid.classList.remove('collapsed', 'expanded');
        return;
      }

      const columns = getColumns();
      const totalCards = cards.length;
      
      if (viewAllContainer) {
        if (totalCards > columns * maxInitialRows) {
          viewAllContainer.style.display = ''; // Show button
        } else {
          viewAllContainer.style.display = 'none'; // Hide button
          cardGrid.style.maxHeight = ''; 
          cardGrid.classList.remove('collapsed', 'expanded');
          return; 
        }
      }

      if (isExpanded) {
        cardGrid.style.maxHeight = cardGrid.scrollHeight + 'px';
        cardGrid.classList.remove('collapsed');
        cardGrid.classList.add('expanded');
      } else {
        if (totalCards <= columns * maxInitialRows) {
          cardGrid.style.maxHeight = ''; 
          cardGrid.classList.remove('collapsed', 'expanded');
        } else {
          const firstCardWrapper = cards[0].closest('.card-slider__grid-item');
          if (!firstCardWrapper) {
            // console.warn('Card Slider: .card-slider__grid-item not found for height calculation.');
            cardGrid.style.maxHeight = '600px'; // Fallback initial height
            cardGrid.classList.add('collapsed');
            cardGrid.classList.remove('expanded');
            return;
          }
          const cardStyle = window.getComputedStyle(firstCardWrapper);
          const cardOuterHeight = firstCardWrapper.offsetHeight + parseInt(cardStyle.marginTop) + parseInt(cardStyle.marginBottom);
          
          const gridStyle = window.getComputedStyle(cardGrid);
          const gridRowGap = parseInt(gridStyle.getPropertyValue('row-gap')) || 0;
          const shadowSpace = 60; // Extra space for the bottom shadow of the last visible row

          let maxHeight = 0;
          if (cardOuterHeight > 0) {
             // Height for 2 rows of cards + 1 row gap + space for shadow of the 2nd row
             maxHeight = (cardOuterHeight * maxInitialRows) + (gridRowGap * (maxInitialRows - 1)) + shadowSpace;
          } else {
            // Fallback if card height is 0
            maxHeight = (300 * maxInitialRows) + (gridRowGap * (maxInitialRows - 1)) + shadowSpace;
          }
          
          cardGrid.style.maxHeight = maxHeight + 'px';
          cardGrid.classList.add('collapsed');
          cardGrid.classList.remove('expanded');
        }
      }
    }
    
    function toggleViewAll() {
      isExpanded = !isExpanded;
      if (viewAllTextExpand && viewAllTextCollapse) {
        viewAllTextExpand.style.display = isExpanded ? 'none' : '';
        viewAllTextCollapse.style.display = isExpanded ? '' : 'none';
      }
      if (cardGrid) {
        if (isExpanded) {
          cardGrid.style.maxHeight = cardGrid.scrollHeight + 'px'; 
          cardGrid.classList.remove('collapsed');
          cardGrid.classList.add('expanded');
          // Optional: reset to 'none' after transition if content inside cards can change height dynamically
          // cardGrid.addEventListener('transitionend', () => { if(isExpanded) cardGrid.style.maxHeight = 'none'; }, { once: true });
        } else {
          // Recalculate and apply collapsed height, a direct call to set fixed height
          calculateAndApplyGridHeight(); 
        }
      }
    }

    if (viewAllButton) {
      viewAllButton.addEventListener('click', toggleViewAll);
    }
    
    // Initial setup for grid height
    // calculateAndApplyGridHeight(); // Called by IntersectionObserver when in view

    window.addEventListener('resize', () => {
      calculateAndApplyGridHeight();
      // Reset hover effects on mobile if cards are being directly manipulated by JS for hover
      if (isMobile()) {
        cards.forEach(card => {
          if (card._hoverState && card._hoverState.isHovering) { // Check if hover state exists
            card.style.transition = '';
            if (card.classList.contains('flipped')) {
              card.style.transform = 'rotateY(180deg) scale(1)';
            } else {
              card.style.transform = 'rotateX(0deg) rotateY(0deg) scale(1)';
            }
            // Potentially reset parts of card._hoverState if needed
          }
        });
      }
    });

    // --- Per-card hover and flip logic (existing, unchanged from original) ---
    function setupCardListeners(card) {
      if (card._interactiveEnabled) return; // Already setup

      const cardId = card.querySelector('.card-slider__card-title')?.textContent || 'UnnamedCard';
      card._hoverState = {
        mouseX: 0,
        mouseY: 0,
        isHovering: false,
        animationFrameId: null,
        mousemoveListener: null 
      };

      const state = card._hoverState;

      function updateTransform() {
        if (!state.isHovering || card.dataset.isFlipping === 'true' || isMobile()) {
          state.animationFrameId = null;
          return;
        }
        const scaleAmount = 1.01;
        if (card.classList.contains('flipped')) {
          card.style.transform = `rotateY(180deg) scale(${scaleAmount})`;
        } else {
          card.style.transform = `scale(${scaleAmount})`;
        }
        state.animationFrameId = null;
      }

      state.boundMousemoveListener = (event) => {
        if (card.dataset.isFlipping === 'true' || isMobile()) return;
        state.mouseX = event.clientX;
        state.mouseY = event.clientY;
        if (card.style.transition !== hoverTransition && !card.dataset.isFlipping) {
          card.style.transition = hoverTransition;
        }
        if (!state.animationFrameId) {
          state.animationFrameId = requestAnimationFrame(updateTransform);
        }
      };

      state.boundMouseenterListener = (event) => {
        state.isHovering = true;
        if (card.dataset.isFlipping === 'true' || isMobile()) return;
        card.style.transition = hoverTransition;
        state.mouseX = event.clientX;
        state.mouseY = event.clientY;
        card.addEventListener('mousemove', state.boundMousemoveListener);
        if (!state.animationFrameId) {
          state.animationFrameId = requestAnimationFrame(updateTransform);
        }
      };

      state.boundMouseleaveListener = () => {
        state.isHovering = false;
        card.removeEventListener('mousemove', state.boundMousemoveListener);
        if (state.animationFrameId) {
          cancelAnimationFrame(state.animationFrameId);
          state.animationFrameId = null;
        }
        if (card.dataset.isFlipping === 'true') return;
        card.style.transition = '';
        if (isMobile()) {
          // On mobile, no scale - only rotation for flip
          card.style.transform = card.classList.contains('flipped') ? 'rotateY(180deg)' : '';
        } else {
          // On desktop, reset scale to 1
          if (card.classList.contains('flipped')) {
            card.style.transform = 'rotateY(180deg) scale(1)';
          } else {
            card.style.transform = 'scale(1)';
          }
        }
      };
      
      state.boundCardClickListener = () => handleCardFlip(card, cardId, state);

      card.addEventListener('mouseenter', state.boundMouseenterListener);
      card.addEventListener('mouseleave', state.boundMouseleaveListener);
      card.addEventListener('click', state.boundCardClickListener);
      
      card._interactiveEnabled = true;
      // console.log(`Card [${cardId}]: Listeners ATTACHED`);
    }

    function teardownCardListeners(card) {
      if (!card._interactiveEnabled || !card._hoverState) return;
      const cardId = card.querySelector('.card-slider__card-title')?.textContent || 'UnnamedCard';
      const state = card._hoverState;

      card.removeEventListener('mouseenter', state.boundMouseenterListener);
      card.removeEventListener('mouseleave', state.boundMouseleaveListener);
      card.removeEventListener('mousemove', state.boundMousemoveListener); 

      card.removeEventListener('click', state.boundCardClickListener);

      if (state.animationFrameId) {
        cancelAnimationFrame(state.animationFrameId);
      }
      card.style.transition = '';
      if (isMobile()) {
        // On mobile, no scale - only rotation for flip
        card.style.transform = card.classList.contains('flipped') ? 'rotateY(180deg)' : '';
      } else {
        // On desktop, reset scale to 1
        if (card.classList.contains('flipped')) {
          card.style.transform = 'rotateY(180deg) scale(1)';
        } else {
          card.style.transform = 'rotateX(0deg) rotateY(0deg) scale(1)';
        }
      }
      delete card.dataset.isFlipping; 
      card._interactiveEnabled = false;
      delete card._hoverState;
      // console.log(`Card [${cardId}]: Listeners DETACHED`);
    }

    function handleCardFlip(card, cardId, state) { 
      if (card.dataset.isFlipping === 'true') return;
      card.dataset.isFlipping = 'true';
      
      // Check if we're on iOS Safari
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
      const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
      const isIOSSafari = isIOS && isSafari;
      
      // Apply specific timing for iOS Safari
      if (isMobile() && isIOSSafari) {
        // For Safari mobile, modify the timing to be smoother
        card.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
        
        // Force layout recalculation before changing classes/transforms
        void card.offsetWidth;
        
        // Toggle the flipped class
        card.classList.toggle('flipped');
        
        // Apply transform
        if (card.classList.contains('flipped')) {
          card.style.transform = 'rotateY(180deg)';
          // Ensure front face is immediately hidden on Safari to avoid flicker
          const frontFace = card.querySelector('.card-slider__card-front');
          const backFace = card.querySelector('.card-slider__card-back');
          if (frontFace) frontFace.style.visibility = 'hidden';
          if (backFace) backFace.style.visibility = 'visible';
        } else {
          card.style.transform = 'rotateY(0deg)';
          // Ensure back face is immediately hidden on Safari to avoid flicker
          const frontFace = card.querySelector('.card-slider__card-front');
          const backFace = card.querySelector('.card-slider__card-back');
          if (backFace) backFace.style.visibility = 'hidden';
          if (frontFace) frontFace.style.visibility = 'visible';
        }
      } else {
        // Normal behavior for non-Safari mobile
        card.style.transition = flipTransition;
        card.classList.toggle('flipped');
        card.style.transform = card.classList.contains('flipped') ? 'rotateY(180deg)' : 'rotateY(0deg)';
      }

      card.addEventListener('transitionend', function onFlipEnd() {
        delete card.dataset.isFlipping;
        
        // Reset visibility for Safari mobile
        if (isMobile() && isIOSSafari) {
          const frontFace = card.querySelector('.card-slider__card-front');
          const backFace = card.querySelector('.card-slider__card-back');
          if (frontFace) frontFace.style.visibility = '';
          if (backFace) backFace.style.visibility = '';
        }
        
        if (state && state.isHovering && card.matches(':hover') && !isMobile()) { 
          card.style.transition = hoverTransition;
          if (!state.animationFrameId) {
             state.animationFrameId = requestAnimationFrame(() => {
                if (state.isHovering && !isMobile()) {
                    const scaleAmount = 1.01;
                    
                    if (card.classList.contains('flipped')) {
                      card.style.transform = `rotateY(180deg) scale(${scaleAmount})`;
                    } else {
                      card.style.transform = `scale(${scaleAmount})`;
                    }
                }
                state.animationFrameId = null;
            });
          }
        } else {
          card.style.transition = ''; 
          card.style.transform = card.classList.contains('flipped') ? 'rotateY(180deg)' : '';  
        }
      }, { once: true });
    }

    // --- Intersection Observer Setup ---
    const observerOptions = {
      root: null, 
      rootMargin: '0px',
      threshold: 0.1 
    };

    const intersectionCallback = (entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // console.log('Card Slider: Section is IN VIEW');
          cards.forEach(setupCardListeners);
          calculateAndApplyGridHeight(); // Calculate height when section becomes visible
        } else {
          // console.log('Card Slider: Section is OUT OF VIEW');
          cards.forEach(teardownCardListeners);
        }
      });
    };

    const observer = new IntersectionObserver(intersectionCallback, observerOptions);
    observer.observe(cardSliderInner); // Observe the main inner container

    // console.log('Card Slider: Script initialized with IntersectionObserver and View All logic.');
  });
</script>

 </div>



 {% schema %}
{
  "name": "card-slider-section",
  "settings": [
    {
      "type": "text",
      "id": "heading_regular",
      "label": "Regular Heading Text",
      "default": "Replace Your Daily Supplements With"
    },
    {
      "type": "text",
      "id": "heading_italic",
      "label": "Italic Heading Text",
      "default": "One Drink"
    },
    {
      "type": "richtext",
      "id": "descriptionvv",
      "label": "Description",
      "default": "<p>I’ve been fortunate to work with some of the world’s top medical professionals...</p>"
    },
{
      "type": "image_picker",
      "id": "header_image",
      "label": "Header Image"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Save Money, Time And Simplify Your Routine With IM8"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>The average health-conscious consumer spends hundreds of dollars monthly on multiple supplements, each addressing only one aspect of health. IM8 Daily Ultimate Essentials consolidates 16 common supplements into one comprehensive formula, saving you money, time, and the hassle of managing multiple products.</p>"
    }

    
  ],

  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "front_image",
          "label": "Front Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Card Title",
          "default": "Card Title"
        },
        {
          "type": "text",
          "id": "front_description",
          "label": "Front Description",
          "default": "Front description goes here"
        },
        {
          "type": "richtext",
          "id": "back_content",
          "label": "Back Content",
          "default": "<p>Back content goes here.</p>"
        },
        {
  "type": "text",
  "id": "button_label",
  "label": "Button Text"
},
{
  "type": "url",
  "id": "button_link",
  "label": "Button Link"
}
      ]
    }
  ],
  "presets": [
    {
      "name": "card-slider-section",
      "category": "Custom"
    }
  ]
}
{% endschema %}


