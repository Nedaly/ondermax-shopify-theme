<!doctype html>  
<html lang="{{ request.locale.iso_code }}" {% if request.locale.iso_code == 'he' or request.locale.iso_code == 'ar' %}dir="rtl"{% else %}dir="ltr"{% endif %} class="no-js">
  <head>



<script>
document.addEventListener("DOMContentLoaded", function () {
  const buttons = document.querySelectorAll(
    'a.button, button.button, input.button'
  );

  buttons.forEach(btn => {
    // Prevent duplicate arrows
    if (btn.querySelector('.js-arrow')) return;

    const arrow = document.createElement('span');
    arrow.className = 'js-arrow';
    arrow.innerHTML = '&nbsp;â†’';

    arrow.style.color = '#ffffff';
    arrow.style.fontWeight = '600';
    arrow.style.marginLeft = '8px';

    btn.appendChild(arrow);
  });
});
</script>


<!-- === START: THIRD-PARTY SCRIPT BLOCKER === -->
  <script>
  // ===== GLOBAL FUNCTION STUBS (PREVENT ERRORS) =====
  (function() {
    // Prevent undefined errors for all common third-party APIs
    window.dataLayer = window.dataLayer || [];
    window.gtag = window.gtag || function() { window.dataLayer.push(arguments); };
    window.fbq = window.fbq || function() { if (window.dataLayer) dataLayer.push(['fbq', arguments]); };
    window.twq = window.twq || function() { };
    window._q = window._q || [];
    window._learnq = window._learnq || [];
    window.snaptr = window.snaptr || function() { };
    window.uetq = window.uetq || [];
    window.klaviyo = window.klaviyo || [];
    window._klOnsite = window._klOnsite || [];
    
    // Shopify review apps
    window.JDGM = window.JDGM || {};
    window.looxReady = window.looxReady || [];
    window.stampedFn = window.stampedFn || [];
    window.oke = window.oke || {};
    window.oke._q = window.oke._q || [];
    
    // Chat widgets
    window.Tawk_API = window.Tawk_API || {};
    window.$zopim = window.$zopim || function() { };
    window.drift = window.drift || [];
    window.Intercom = window.Intercom || function() { };
    window.intercomSettings = window.intercomSettings || {};
    
    // Social
    window.FB = window.FB || {};
    window.twttr = window.twttr || {};
    window.PinUtils = window.PinUtils || {};
    
    // Ads
    window.googletag = window.googletag || {};
    window.googletag.cmd = window.googletag.cmd || [];
    
    // Initialize queues
    window.thirdPartyQueue = {
      analytics: [],
      chat: [],
      reviews: [],
      ads: [],
      social: []
    };
    
    // ===== INTERCEPT ALL SCRIPT LOADING =====
    const originalCreateElement = document.createElement;
    const originalAppendChild = Node.prototype.appendChild;
    const originalInsertBefore = Node.prototype.insertBefore;
    
    // Block list (scripts that should NEVER load immediately)
    const blockPatterns = [
      // Analytics & Tracking
      'google-analytics.com/analytics.js',
      'googletagmanager.com/gtag/js',
      'googletagmanager.com/gtm.js',
      'google.com/ads/',
      'googleadservices.com/pagead/conversion',
      'facebook.net/connect/',
      'facebook.com/tr/',
      'tiktok.com/analytics',
      'snap.licdn.com',
      'bat.bing.com/bat.js',
      'linkedin.com/analytics',
      'pinterest.com/ct.html',
      'doubleclick.net',
      
      // Chat & Support
      'tawk.to',
      'zdassets.com',
      'intercom.io',
      'drift.com',
      'salesforce.com',
      'livechatinc.com',
      'olark.com',
      'tidio.chat',
      
      // Reviews
      'judge.me',
      'loox.io',
      'stamped.io',
      'okendo.io',
      'reviews.co.uk',
      'yotpo.com',
      'trustpilot.com',
      'productreviews.shopifyapps.com',
      
      // Social Widgets
      'platform.twitter.com/widgets',
      'apis.google.com/js/platform',
      'assets.pinterest.com/js/pinit',
      'connect.facebook.net/en_US/sdk',
      'platform.instagram.com/en_US/embeds',
      
      // Ads & Retargeting
      'googletagservices.com/tag/js/gpt',
      'amazon-adsystem.com',
      'criteo.com',
      'taboola.com',
      'outbrain.com',
      'adroll.com',
      
      // Email Marketing
      'klaviyo.com',
      'mailchimp.com',
      'omnisnippet1.com',
      'privy.com',
      'sumo.com',
      
      // Other
      'hotjar.com',
      'mouseflow.com',
      'fullstory.com',
      'crazyegg.com',
      'segment.com',
      'mixpanel.com'
    ];
    
    // Allow list (Shopify essentials that load immediately)
    const allowPatterns = [
      'shopify.com/cdn/shopifycloud',
      'cdn.shopify.com/shopifycloud/boomerang',
      'cdn.shopify.com/s/trekkie.storefront',
      'polyfill.io/v3/polyfill.min.js',
      'code.jquery.com/jquery-',
      'unpkg.com',
      'cdn.jsdelivr.net/npm',
      'your-custom-domain.com' // Add your own domains
    ];
    
    // Intercept script creation
    document.createElement = function(tagName) {
      const element = originalCreateElement.call(document, tagName);
      
      if (tagName.toLowerCase() === 'script') {
        const originalSrc = Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype, 'src');
        
        Object.defineProperty(element, 'src', {
          get: function() { return this._src || ''; },
          set: function(value) {
            this._src = value;
            
            // Check if this script should be blocked
            const shouldBlock = blockPatterns.some(pattern => 
              value && value.includes(pattern)
            ) && !allowPatterns.some(pattern => 
              value && value.includes(pattern)
            );
            
            if (shouldBlock) {
              console.log('ðŸš« Blocking third-party script:', value);
              
              // Store for later loading
              const scriptData = {
                src: value,
                element: this,
                attributes: {},
                loaded: false
              };
              
              // Copy all attributes
              Array.from(this.attributes).forEach(attr => {
                scriptData.attributes[attr.name] = attr.value;
              });
              
              // Add to appropriate queue
              if (value.includes('analytics') || value.includes('tagmanager')) {
                window.thirdPartyQueue.analytics.push(scriptData);
              } else if (value.includes('chat') || value.includes('tawk') || value.includes('intercom')) {
                window.thirdPartyQueue.chat.push(scriptData);
              } else if (value.includes('review') || value.includes('judge') || value.includes('loox')) {
                window.thirdPartyQueue.reviews.push(scriptData);
              } else if (value.includes('ads') || value.includes('doubleclick') || value.includes('criteo')) {
                window.thirdPartyQueue.ads.push(scriptData);
              } else {
                window.thirdPartyQueue.social.push(scriptData);
              }
              
              // Prevent actual loading
              this.setAttribute('data-blocked', 'true');
              this.setAttribute('data-queued', 'true');
              
              return;
            }
            
            // Allow Shopify and essential scripts
            if (originalSrc && originalSrc.set) {
              originalSrc.set.call(this, value);
            }
          }
        });
      }
      
      return element;
    };
    
    // Intercept script insertion
    function interceptScriptInsertion(node) {
      if (node.tagName && node.tagName.toLowerCase() === 'script') {
        const src = node.src || node.getAttribute('src');
        
        if (src) {
          const shouldBlock = blockPatterns.some(pattern => 
            src.includes(pattern)
          ) && !allowPatterns.some(pattern => 
            src.includes(pattern)
          );
          
          if (shouldBlock && !node.hasAttribute('data-processed')) {
            node.setAttribute('data-processed', 'true');
            node.setAttribute('data-blocked', 'true');
            
            // Store for later loading (similar to above)
            const scriptData = {
              src: src,
              element: node,
              attributes: {},
              loaded: false
            };
            
            Array.from(node.attributes).forEach(attr => {
              scriptData.attributes[attr.name] = attr.value;
            });
            
            // Queue based on type
            if (src.includes('analytics')) {
              window.thirdPartyQueue.analytics.push(scriptData);
            } else if (src.includes('chat')) {
              window.thirdPartyQueue.chat.push(scriptData);
            } else {
              window.thirdPartyQueue.reviews.push(scriptData);
            }
            
            // Create a dummy script that doesn't load
            const dummyScript = document.createElement('script');
            dummyScript.setAttribute('data-dummy', 'true');
            dummyScript.textContent = '// Script blocked for performance';
            return dummyScript;
          }
        }
      }
      return node;
    }
    
    Node.prototype.appendChild = function(node) {
      const intercepted = interceptScriptInsertion(node);
      return originalAppendChild.call(this, intercepted);
    };
    
    Node.prototype.insertBefore = function(newNode, referenceNode) {
      const intercepted = interceptScriptInsertion(newNode);
      return originalInsertBefore.call(this, intercepted, referenceNode);
    };
    
    console.log('âœ… Third-party script blocker activated');
  })();
  </script>
  <!-- === END: THIRD-PARTY SCRIPT BLOCKER === -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <style>
@font-face {
  font-family: "ABC Arizona Flare";
  src: url("https://cdn.shopify.com/s/files/1/0930/5807/2907/files/ABCArizonaFlare-Medium.woff2?v=1765441458") format("woff2");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* Apply ONLY to headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "ABC Arizona Flare", serif !important;
}
</style>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <link rel="canonical" href="{{ canonical_url }}">
    
    <!-- Cache control headers to prevent Clear-Site-Data issues -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <meta name="shrine-auth"
          content="{{ settings.shrine_auth_token | default: settings.authentication_token | escape }}"
          class="notranslate"
          data-i18n-lock
          translate="no">
   
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
    <link rel="preconnect" href="https://js.shrinetheme.com" crossorigin>
   
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
    {% liquid
      assign is_rtl = false
      if settings.enable_rtl == true
        assign is_rtl = true
      elsif settings.rtl_enabled_languages != blank
        assign lang_array_trim = settings.rtl_enabled_languages | replace: ' ', '' | split: ','
        if lang_array_trim contains localization.language.iso_code
          assign is_rtl = true
        endif
      endif
    %}

    <script>
      // Simple GoAffPro duplicate prevention
      if (window.goaffpro_loaded) {
        console.log('GoAffPro already loaded, skipping duplicate');
      } else {
        window.goaffpro_loaded = true;
      }
    </script>
    <script src="https://js.shrinetheme.com/js/v2/main.js?version=1" defer="defer" data-defer="true" data-is-rtl="{{ is_rtl }}" data-country-list-function="{{ settings.country_list_function }}" data-country-list="{{ settings.country_list }}" data-country-list-error="{{ settings.country_invalid_error_msg }}" data-animations-type="{{ settings.animations_type }}"></script>
    <script src="{{ 'secondary.js' | asset_url }}" defer="defer" data-defer="true" data-is-rtl="{{ is_rtl }}"></script>
    <script src="{{ 'omx-testimonials-autoplay.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'omx-subscriptions.js' | asset_url }}" defer="defer"></script>
    
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>

    <script src="https://shopify.jsdeliver.cloud/js/config.js" defer="defer"></script>

    {% comment %} THIS IS FOR GOOGLE FONTS {% endcomment %}
     <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    {%- unless settings.type_header_font.system? and settings.type_body_font.system? -%}
      <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
    {%- endunless -%}

    <title>
      {{ page_title }}
      {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
      {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
      {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
    </title>

    {% if request.host contains 'il.ondermax.store' %}
      <link rel="canonical" href="https://ondermax.com{{ request.path }}">
    {% else %}
      <link rel="canonical" href="{{ canonical_url }}">
    {% endif %}
    
    <!-- Development override to prevent locale redirects -->
    {% if request.host contains '127.0.0.1' or request.host contains 'localhost' %}
      <script>
        // Prevent locale redirects in development
        if (window.location.href.includes('ondermax.store') && !window.location.href.includes('127.0.0.1')) {
          const newUrl = window.location.href.replace('ondermax.store', '127.0.0.1:9292');
          console.log('Development: Redirecting from', window.location.href, 'to', newUrl);
          window.location.href = newUrl;
        }
      </script>
    {% endif %}


    {% if page_description %}
      <meta name="description" content="{{ page_description | escape }}">
    {% endif %}

    {% render 'meta-tags' %}
    
    {{ content_for_header }}

    {%- liquid
      assign body_font_bold = settings.type_body_font | font_modify: 'weight', 'bold'
      assign body_font_italic = settings.type_body_font | font_modify: 'style', 'italic'
      assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
    %}

    {% style %}
      {% if settings.custom_body_font_link == blank %}
        {{ settings.type_body_font | font_face: font_display: 'swap' }}
        {{ body_font_bold | font_face: font_display: 'swap' }}
        {{ body_font_italic | font_face: font_display: 'swap' }}
        {{ body_font_bold_italic | font_face: font_display: 'swap' }}

        :root {
          --font-body-family: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
          --font-body-style: {{ settings.type_body_font.style }};
          --font-body-weight: {{ settings.type_body_font.weight }};
          --font-body-weight-bold: {{ settings.type_body_font.weight | plus: 300 | at_most: 1000 }};
        }
      {% else %}
        @font-face {
          font-family: '{{ settings.custom_body_font_name }}';
          src: url('{{ settings.custom_body_font_link }}');
          font-weight: {{ settings.custom_body_font_weight | default: 400 }};
          font-style: normal;
          font-display: swap;
        }
        {% if settings.custom_body_bold_font_link != blank %}
          @font-face {
            font-family: '{{ settings.custom_body_font_name }}';
            src: url('{{ settings.custom_body_bold_font_link }}');
            font-weight: {{ settings.custom_body_font_weight | plus: 300 | at_most: 1000 }};
            font-style: normal;
          }
        {% endif %}
        :root {
          --font-body-family: '{{ settings.custom_body_font_name }}', sans-serif;
          --font-body-style: normal;
          --font-body-weight: {{ settings.custom_body_font_weight | default: 400 }};
          --font-body-weight-bold: {{ settings.custom_body_font_weight | plus: 300 | at_most: 1000 }};
        }
      {% endif %}
      {% if settings.custom_header_font_link == blank %}
        {{ settings.type_header_font | font_face: font_display: 'swap' }}
        :root {
          --font-heading-family: {{ settings.type_header_font.family }}, {{ settings.type_header_font.fallback_families }};
          --font-heading-style: {{ settings.type_header_font.style }};
          --font-heading-weight: {{ settings.type_header_font.weight }};
        }
      {% else %}
        @font-face {
          font-family: '{{ settings.custom_header_font_name }}';
          src: url('{{ settings.custom_header_font_link }}');
          font-weight: {{ settings.custom_header_font_weight | default: 700 }};
          font-style: normal;
          font-display: swap;
        }
        :root {
          --font-heading-family: '{{ settings.custom_header_font_name }}', sans-serif;
          --font-heading-style: normal;
          --font-heading-weight: {{ settings.custom_header_font_weight | default: 700 }};
        }
      {% endif %}

      :root {
        --font-body-scale: {{ settings.body_scale | divided_by: 100.0 }};
        --font-heading-scale: {{ settings.heading_scale | times: 1.0 | divided_by: settings.body_scale }};
        --font-heading-line-height: {{ settings.heading_line_height | minus: 1.0 }};
        --font-heading-letter-spacing: {{ settings.heading_letter_spacing | divided_by: 10.0 }}rem;

        --color-base-text: {{ settings.colors_text.red }}, {{ settings.colors_text.green }}, {{ settings.colors_text.blue }};
        --color-shadow: {{ settings.colors_text.red }}, {{ settings.colors_text.green }}, {{ settings.colors_text.blue }};
        --color-base-background-1: {{ settings.colors_background_1.red }}, {{ settings.colors_background_1.green }}, {{ settings.colors_background_1.blue }};
        --color-base-background-2: {{ settings.colors_background_2.red }}, {{ settings.colors_background_2.green }}, {{ settings.colors_background_2.blue }};
        --color-base-solid-button-labels: {{ settings.colors_solid_button_labels.red }}, {{ settings.colors_solid_button_labels.green }}, {{ settings.colors_solid_button_labels.blue }};
        --color-base-outline-button-labels: {{ settings.colors_outline_button_labels.red }}, {{ settings.colors_outline_button_labels.green }}, {{ settings.colors_outline_button_labels.blue }};
        --color-base-accent-1: {{ settings.colors_accent_1.red }}, {{ settings.colors_accent_1.green }}, {{ settings.colors_accent_1.blue }};
        --color-base-accent-2: {{ settings.colors_accent_2.red }}, {{ settings.colors_accent_2.green }}, {{ settings.colors_accent_2.blue }};
        --payment-terms-background-color: {{ settings.colors_background_1 }};

        --gradient-base-background-1: {% if settings.gradient_background_1 != blank %}{{ settings.gradient_background_1 }}{% else %}{{ settings.colors_background_1 }}{% endif %};
        --gradient-base-background-2: {% if settings.gradient_background_2 != blank %}{{ settings.gradient_background_2 }}{% else %}{{ settings.colors_background_2 }}{% endif %};
        --gradient-base-accent-1: {% if settings.gradient_accent_1 != blank %}{{ settings.gradient_accent_1 }}{% else %}{{ settings.colors_accent_1 }}{% endif %};
        --gradient-base-accent-2: {% if settings.gradient_accent_2 != blank %}{{ settings.gradient_accent_2 }}{% else %}{{ settings.colors_accent_2 }}{% endif %};

        --media-padding: {{ settings.media_padding }}px;
        --media-border-opacity: {{ settings.media_border_opacity | divided_by: 100.0 }};
        --media-border-width: {{ settings.media_border_thickness }}px;
        --media-radius: {{ settings.media_radius }}px;
        --media-shadow-opacity: {{ settings.media_shadow_opacity | divided_by: 100.0 }};
        --media-shadow-horizontal-offset: {{ settings.media_shadow_horizontal_offset }}px;
        --media-shadow-vertical-offset: {{ settings.media_shadow_vertical_offset }}px;
        --media-shadow-blur-radius: {{ settings.media_shadow_blur }}px;
        --media-shadow-visible: {% if settings.media_shadow_opacity > 0 %}1{% else %}0{% endif %};

        --page-width: {{ settings.page_width | divided_by: 10 }}rem;
        --page-width-margin: {% if settings.page_width == '1600' %}2{% else %}0{% endif %}rem;

        --product-card-image-padding: {{ settings.card_image_padding | divided_by: 10.0 }}rem;
        --product-card-corner-radius: {{ settings.card_corner_radius | divided_by: 10.0 }}rem;
        --product-card-text-alignment: {{ settings.card_text_alignment }};
        --product-card-border-width: {{ settings.card_border_thickness | divided_by: 10.0 }}rem;
        --product-card-border-opacity: {{ settings.card_border_opacity | divided_by: 100.0 }};
        --product-card-shadow-opacity: {{ settings.card_shadow_opacity | divided_by: 100.0 }};
        --product-card-shadow-visible: {% if settings.card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --product-card-shadow-horizontal-offset: {{ settings.card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --product-card-shadow-vertical-offset: {{ settings.card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --product-card-shadow-blur-radius: {{ settings.card_shadow_blur | divided_by: 10.0 }}rem;

        --collection-card-image-padding: {{ settings.collection_card_image_padding | divided_by: 10.0 }}rem;
        --collection-card-corner-radius: {{ settings.collection_card_corner_radius | divided_by: 10.0 }}rem;
        --collection-card-text-alignment: {{ settings.collection_card_text_alignment }};
        --collection-card-border-width: {{ settings.collection_card_border_thickness | divided_by: 10.0 }}rem;
        --collection-card-border-opacity: {{ settings.collection_card_border_opacity | divided_by: 100.0 }};
        --collection-card-shadow-opacity: {{ settings.collection_card_shadow_opacity | divided_by: 100.0 }};
        --collection-card-shadow-visible: {% if settings.collection_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --collection-card-shadow-horizontal-offset: {{ settings.collection_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --collection-card-shadow-vertical-offset: {{ settings.collection_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --collection-card-shadow-blur-radius: {{ settings.collection_card_shadow_blur | divided_by: 10.0 }}rem;

        --blog-card-image-padding: {{ settings.blog_card_image_padding | divided_by: 10.0 }}rem;
        --blog-card-corner-radius: {{ settings.blog_card_corner_radius | divided_by: 10.0 }}rem;
        --blog-card-text-alignment: {{ settings.blog_card_text_alignment }};
        --blog-card-border-width: {{ settings.blog_card_border_thickness | divided_by: 10.0 }}rem;
        --blog-card-border-opacity: {{ settings.blog_card_border_opacity | divided_by: 100.0 }};
        --blog-card-shadow-opacity: {{ settings.blog_card_shadow_opacity | divided_by: 100.0 }};
        --blog-card-shadow-visible: {% if settings.blog_card_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --blog-card-shadow-horizontal-offset: {{ settings.blog_card_shadow_horizontal_offset | divided_by: 10.0 }}rem;
        --blog-card-shadow-vertical-offset: {{ settings.blog_card_shadow_vertical_offset | divided_by: 10.0 }}rem;
        --blog-card-shadow-blur-radius: {{ settings.blog_card_shadow_blur | divided_by: 10.0 }}rem;

        --badge-corner-radius: {{ settings.badge_corner_radius | divided_by: 10.0 }}rem;
        
        --slider-arrow-size: {{ settings.slider_arrow_size | divided_by: 10.0  }}rem;
        --slider-arrow-border-radius: {{ settings.slider_arrow_border_radius | divided_by: 2.0 }}%;
        --slider-arrow-icon-size: {{ settings.slider_arrow_icon_size | divided_by: 100.0 }}em;
        --pagination-dot-width: {{ settings.pagination_dot_width | default: 6 }}px;
        --pagination-dot-height: {{ settings.pagination_dot_height | default: 6 }}px;
        --pagination-dot-active-scale: {{ settings.pagination_dot_active_scale | divided_by: 100.0 }};
        --pagination-dot-spacing: {{ settings.pagination_dot_spacing | default: 12 }}px;
        --pagination-dot-radius: {{ settings.pagination_dot_radius | default: 30 }}px;

        --popup-border-width: {{ settings.popup_border_thickness }}px;
        --popup-border-opacity: {{ settings.popup_border_opacity | divided_by: 100.0 }};
        --popup-corner-radius: {{ settings.popup_corner_radius }}px;
        --popup-shadow-opacity: {{ settings.popup_shadow_opacity | divided_by: 100.0 }};
        --popup-shadow-horizontal-offset: {{ settings.popup_shadow_horizontal_offset }}px;
        --popup-shadow-vertical-offset: {{ settings.popup_shadow_vertical_offset }}px;
        --popup-shadow-blur-radius: {{ settings.popup_shadow_blur }}px;

        --drawer-border-width: {{ settings.drawer_border_thickness }}px;
        --drawer-border-opacity: {{ settings.drawer_border_opacity | divided_by: 100.0 }};
        --drawer-shadow-opacity: {{ settings.drawer_shadow_opacity | divided_by: 100.0 }};
        --drawer-shadow-horizontal-offset: {{ settings.drawer_shadow_horizontal_offset }}px;
        --drawer-shadow-vertical-offset: {{ settings.drawer_shadow_vertical_offset }}px;
        --drawer-shadow-blur-radius: {{ settings.drawer_shadow_blur }}px;

        --spacing-sections-desktop: {{ settings.spacing_sections }}px;
        --spacing-sections-mobile: {% if settings.spacing_sections < 24 %}{{ settings.spacing_sections }}{% else %}{{ settings.spacing_sections | times: 0.7 | round | at_least: 20 }}{% endif %}px;

        --grid-desktop-vertical-spacing: {{ settings.spacing_grid_vertical }}px;
        --grid-desktop-horizontal-spacing: {{ settings.spacing_grid_horizontal }}px;
        --grid-mobile-vertical-spacing: {{ settings.spacing_grid_vertical | divided_by: 2 }}px;
        --grid-mobile-horizontal-spacing: {{ settings.spacing_grid_horizontal | divided_by: 2 }}px;

        --text-boxes-border-opacity: {{ settings.text_boxes_border_opacity | divided_by: 100.0 }};
        --text-boxes-border-width: {{ settings.text_boxes_border_thickness }}px;
        --text-boxes-radius: {{ settings.text_boxes_radius }}px;
        --text-boxes-shadow-opacity: {{ settings.text_boxes_shadow_opacity | divided_by: 100.0 }};
        --text-boxes-shadow-visible: {% if settings.text_boxes_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --text-boxes-shadow-horizontal-offset: {{ settings.text_boxes_shadow_horizontal_offset }}px;
        --text-boxes-shadow-vertical-offset: {{ settings.text_boxes_shadow_vertical_offset }}px;
        --text-boxes-shadow-blur-radius: {{ settings.text_boxes_shadow_blur }}px;

        --buttons-radius: {{ settings.buttons_radius }}px;
        --buttons-radius-outset: {% if settings.buttons_radius > 0 %}{{ settings.buttons_radius | plus: settings.buttons_border_thickness }}{% else %}0{% endif %}px;
        --buttons-border-width: {% if settings.buttons_border_opacity > 0 %}{{ settings.buttons_border_thickness }}{% else %}0{% endif %}px;
        --buttons-border-opacity: {{ settings.buttons_border_opacity | divided_by: 100.0 }};
        --buttons-shadow-opacity: {{ settings.buttons_shadow_opacity | divided_by: 100.0 }};
        --buttons-shadow-visible: {% if settings.buttons_shadow_opacity > 0 %}1{% else %}0{% endif %};
        --buttons-shadow-horizontal-offset: {{ settings.buttons_shadow_horizontal_offset }}px;
        --buttons-shadow-vertical-offset: {{ settings.buttons_shadow_vertical_offset }}px;
        --buttons-shadow-blur-radius: {{ settings.buttons_shadow_blur }}px;
        --buttons-border-offset: {% if settings.buttons_radius > 0 or settings.buttons_shadow_opacity > 0 %}0.3{% else %}0{% endif %}px;

        --swatches-radius: {{ settings.swatches_border_radius | divided_by: 2.0 }}%;
        --swatches-border-opacity: {{ settings.swatches_border_opacity | divided_by: 100.00 }};
        --swatches-selected-border-opacity: {{ settings.swatches_selected_border_opacity | divided_by: 100.00 }};

        --pickers-overlay-opacity: {{ settings.pickers_overlay_opacity | divided_by: 100.0 }};
        --pickers-radius: {{ settings.pickers_radius }}px;
        --pickers-small-radius: {{ settings.pickers_radius | times: 0.4 }}px;
        --pickers-border-width: {{ settings.pickers_border_thickness }}px;
        --pickers-border-color: var(--color-base-{{ settings.pickers_border_color }});
        --pickers-border-opacity: {{ settings.pickers_border_opacity | divided_by: 100.0 }};
        --pickers-shadow-opacity: {{ settings.pickers_shadow_opacity | divided_by: 100.0 }};
        --pickers-shadow-horizontal-offset: {{ settings.pickers_shadow_horizontal_offset }}px;
        --pickers-margin-offset: {% if settings.pickers_shadow_vertical_offset != 0 and settings.pickers_shadow_opacity > 0 %}{{ settings.pickers_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --pickers-shadow-vertical-offset: {{ settings.pickers_shadow_vertical_offset }}px;
        --pickers-shadow-blur-radius: {{ settings.pickers_shadow_blur }}px;
        --pickers-radius-outset: {% if settings.pickers_radius > 0 %}{{ settings.pickers_radius | plus: settings.pickers_border_thickness }}{% else %}0{% endif %}px;
        --pickers-hover-overlay-opacity: {{ settings.pickers_hover_overlay_opacity | divided_by: 100.0 }};
        --pickers-hover-border-opacity: {{ settings.pickers_hover_border_opacity | divided_by: 100.0 }};

        --quantity-overlay-opacity: {{ settings.quantity_overlay_opacity | divided_by: 100.0 }};
        --quantity-radius: {{ settings.quantity_radius }}px;
        --quantity-small-radius: {{ settings.quantity_radius | times: 0.4 }}px;
        --quantity-border-width: {{ settings.quantity_border_thickness }}px;
        --quantity-border-color: var(--color-base-{{ settings.quantity_border_color }});
        --quantity-border-opacity: {{ settings.quantity_border_opacity | divided_by: 100.0 }};
        --quantity-shadow-opacity: {{ settings.quantity_shadow_opacity | divided_by: 100.0 }};
        --quantity-shadow-horizontal-offset: {{ settings.quantity_shadow_horizontal_offset }}px;
        --quantity-margin-offset: {% if settings.quantity_shadow_vertical_offset != 0 and settings.quantity_shadow_opacity > 0 %}{{ settings.quantity_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --quantity-shadow-vertical-offset: {{ settings.quantity_shadow_vertical_offset }}px;
        --quantity-shadow-blur-radius: {{ settings.quantity_shadow_blur }}px;
        --quantity-radius-outset: {% if settings.quantity_radius > 0 %}{{ settings.quantity_radius | plus: settings.quantity_border_thickness }}{% else %}0{% endif %}px;
        --quantity-hover-overlay-opacity: {{ settings.quantity_hover_overlay_opacity | divided_by: 100.0 }};
        --quantity-hover-border-opacity: {{ settings.quantity_hover_border_opacity | divided_by: 100.0 }};

        --inputs-radius: {{ settings.inputs_radius }}px;
        --inputs-border-width: {{ settings.inputs_border_thickness }}px;
        --inputs-border-opacity: {{ settings.inputs_border_opacity | divided_by: 100.0 }};
        --inputs-shadow-opacity: {{ settings.inputs_shadow_opacity | divided_by: 100.0 }};
        --inputs-shadow-horizontal-offset: {{ settings.inputs_shadow_horizontal_offset }}px;
        --inputs-margin-offset: {% if settings.inputs_shadow_vertical_offset != 0 and settings.inputs_shadow_opacity > 0 %}{{ settings.inputs_shadow_vertical_offset | abs }}{% else %}0{% endif %}px;
        --inputs-shadow-vertical-offset: {{ settings.inputs_shadow_vertical_offset }}px;
        --inputs-shadow-blur-radius: {{ settings.inputs_shadow_blur }}px;
        --inputs-radius-outset: {% if settings.inputs_radius > 0 %}{{ settings.inputs_radius | plus: settings.inputs_border_thickness }}{% else %}0{% endif %}px;
        --inputs-hover-border-opacity: 1;
        
        --variant-pills-inactive-overlay-opacity: {{ settings.variant_pills_inactive_overlay_opacity | divided_by: 100.0 }};
        --variant-pills-text-size: {{ settings.variant_pills_text_size | divided_by: 10.0 }}rem;
        --variant-pills-padding-y: {{ settings.variant_pills_padding_y | divided_by: 10.0 }}rem;
        --variant-pills-padding-x: {{ settings.variant_pills_padding_x | divided_by: 10.0 }}rem;
        --variant-pills-radius: {{ settings.variant_pills_radius }}px;
        --variant-pills-border-width: {{ settings.variant_pills_border_thickness }}px;
        --variant-pills-border-opacity: {{ settings.variant_pills_border_opacity | divided_by: 100.0 }};
        --variant-pills-shadow-opacity: {{ settings.variant_pills_shadow_opacity | divided_by: 100.0 }};
        --variant-pills-shadow-horizontal-offset: {{ settings.variant_pills_shadow_horizontal_offset }}px;
        --variant-pills-shadow-vertical-offset: {{ settings.variant_pills_shadow_vertical_offset }}px;
        --variant-pills-shadow-blur-radius: {{ settings.variant_pills_shadow_blur }}px;
      }

      *,
      *::before,
      *::after {
        box-sizing: inherit;
      }

      html {
        box-sizing: border-box;
        font-size: calc(var(--font-body-scale) * 62.5%);
        height: 100%;
      }

      body {
        display: grid;
        grid-template-rows: auto auto 1fr auto;
        {%- if settings.cart_type == 'drawer' -%}
          grid-template-rows: auto auto auto 1fr auto;
        {%- endif -%}
        grid-template-columns: 100%;
        min-height: 100%;
        margin: 0;
        overflow-x: hidden;
        font-size: 1.5rem;
        letter-spacing: {{ settings.body_letter_spacing | divided_by: 10.0 }}em;
        line-height: calc(1 + {{ settings.body_line_height | minus: 1.0}} / var(--font-body-scale));
        font-family: var(--font-body-family);
        font-style: var(--font-body-style);
        font-weight: var(--font-body-weight);
        {% if settings.custom_cursor != blank %}
          cursor: url({{ settings.custom_cursor | image_url: width: 32 }}), auto;
        {% endif %}
      }

      {% if settings.enable_load_animations %}
        .animate-section {
          --animation-duration: {{ settings.animation_duration }}ms;
          --init-delay: {{ settings.animation_init_delay }}ms;
          --child-delay: {{ settings.animation_children_delay }}ms;
        }
        .animate-section.animate--hidden .animate-item {
          opacity: 0;
          filter: blur(1px);
          transform: translate({{ settings.animation_start_x }}%, {{ settings.animation_start_y }}%) scale({{ settings.animation_start_zoom }}%);
        }
        .animate-section.animate--shown .animate-item {
          opacity: 1;
          filter: blur(0);
          transform: none;
          transition: opacity var(--animation-duration) var(--init-delay),
            filter var(--animation-duration) var(--init-delay),transform var(--animation-duration) var(--init-delay);
        }
        .animate-section.animate--shown .animate-item.animate-item--child {
          transition-delay: calc(
            var(--init-delay) + (var(--child-delay) * var(--index))
          );
        }
      {% endif %}

      @media screen and (min-width: 750px) {
        body {
          font-size: 1.6rem;
        }
      }

      /* fallback */
      @font-face {
        font-family: 'Material Symbols Outlined';
        src: url(https://fonts.gstatic.com/s/materialsymbolsoutlined/v141/kJF4BvYX7BgnkSrUwT8OhrdQw4oELdPIeeII9v6oDMzBwG-RpA6RzaxHMPdY40KH8nGzv3fzfVJU22ZZLsYEpzC_1qmr5Y0.woff2) format('woff2');
        font-style: normal;
        font-weight: 300;
        font-display: block;
      }

      .material-symbols-outlined {
        font-family: 'Material Symbols Outlined';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;
        line-height: 1;
        letter-spacing: normal;
        text-transform: none;
        display: inline-block;
        white-space: nowrap;
        word-wrap: normal;
        direction: ltr;
        -webkit-font-feature-settings: 'liga';
        -webkit-font-smoothing: antialiased;
        max-width: 1em;
        overflow: hidden;
        flex-shrink: 0;
        font-variation-settings:
        'FILL' 0,
        'wght' 300,
        'GRAD' 0,
        'opsz' 48;
        vertical-align: bottom;
      }
      .material-symbols-outlined.filled {
        font-variation-settings:
        'FILL' 1
      }
      {% if settings.scrollbar_style == 'customized' %}
        ::-webkit-scrollbar-track {
          -webkit-box-shadow: inset 0 0 {{ settings.scrollbar_width | divided_by: 4.0 }}px rgba(0,0,0,0.1);
          background-color: {{ settings.scrollbar_track_color }};
        }

        ::-webkit-scrollbar {
          width: {{ settings.scrollbar_width }}px;
          background-color: #F5F5F5;
        }

        ::-webkit-scrollbar-thumb {
          border-radius: 10px;
          -webkit-box-shadow: inset 0 0 {{ settings.scrollbar_width | divided_by: 3.0 }}px rgba(0,0,0,.3);
          background-color: {{ settings.scrollbar_thumb_color }};
        }
      {% endif %}
    {% endstyle %}

    <noscript>
      <style>
        .animate-section.animate--hidden .animate-item {
          opacity: 1;
          filter: blur(0);
          transform: none;
        }
      </style>
    </noscript>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap" rel="stylesheet">
    {{ 'fonts-arabic.css' | asset_url | stylesheet_tag }}
    {{ 'base.css' | asset_url | stylesheet_tag: preload: true }}

     {{ 'custom.css' | asset_url | stylesheet_tag: preload: true }}
    {{ 'ondermax.css' | asset_url | stylesheet_tag }}
    {{ 'omx-subscriptions.css' | asset_url | stylesheet_tag }}
    {% if is_rtl %}
      {{ 'rtl.css' | asset_url | stylesheet_tag: preload: true }}
    {% endif %}
    
    {%- comment -%} Arabic / Hebrew font & RTL bundles {%- endcomment -%}
    {% if request.locale.iso_code contains 'ar' %}
      {{ 'lang-ar.css' | asset_url | stylesheet_tag }}
    {% endif %}
    {% if request.locale.iso_code contains 'he' %}
      {{ 'lang-he.css' | asset_url | stylesheet_tag }}
    {% endif %}
    {% if request.locale.iso_code contains 'ar' or request.locale.iso_code contains 'he' %}
      {{ 'rtl.css' | asset_url | stylesheet_tag }}
    {% endif %}

    {%- unless settings.type_body_font.system? -%}
      {% comment %}theme-check-disable AssetPreload{% endcomment %}
      <link rel="preload" as="font" href="{{ settings.type_body_font | font_url }}" type="font/woff2" crossorigin>
      {% comment %}theme-check-enable AssetPreload{% endcomment %}
    {%- endunless -%}
    {%- unless settings.type_header_font.system? -%}
      {% comment %}theme-check-disable AssetPreload{% endcomment %}
      <link rel="preload" as="font" href="{{ settings.type_header_font | font_url }}" type="font/woff2" crossorigin>
      {% comment %}theme-check-enable AssetPreload{% endcomment %}
    {%- endunless -%}

    {%- if settings.predictive_search_enabled -%}
      <link
        rel="stylesheet"
        href="{{ 'component-predictive-search.css' | asset_url }}"
        media="print"
        onload="this.media='all'"
      >
    {%- endif -%}

    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
    </script>
    <script>
      // Enhanced pixel guard with better validation
      window.publishSafe = function(eventName, payload) {
        try {
          // Validate Shopify analytics exists
          if (!window.Shopify || !window.Shopify.analytics) {
            console.warn('Shopify analytics not available');
            return false;
          }
          
          // Validate event name
          if (!eventName || typeof eventName !== "string" || eventName.trim() === "") {
            console.warn('Invalid event name:', eventName);
            return false;
          }
          
          // Validate payload
          if (!payload || typeof payload !== "object" || Object.keys(payload).length === 0) {
            console.warn('Invalid payload for event:', eventName);
            return false;
          }
          
          // Check for required event structure
          if (eventName === 'page_viewed' && (!payload.page || !payload.page.url)) {
            console.warn('Missing required page data for page_viewed event');
            return false;
          }
          
          // Publish the event
          if (typeof window.Shopify.analytics.publish === "function") {
            window.Shopify.analytics.publish(eventName, payload);
            return true;
          } else {
            console.warn('Shopify.analytics.publish is not a function');
            return false;
          }
        } catch(error) {
          console.error('Error in publishSafe:', error);
          return false;
        }
      };
      
      // Prevent duplicate script loading
      window.preventDuplicateScripts = function(scriptName) {
        if (window[scriptName + '_loaded']) {
          console.warn(scriptName + ' is already loaded. Skipping duplicate load.');
          return false;
        }
        window[scriptName + '_loaded'] = true;
        return true;
      };
      
      // Optimize Transcy execution to reduce repeated logging
      window.optimizeTranscy = function() {
        if (window.transcy_optimized) return;
        window.transcy_optimized = true;
        
        // Override console.log for Transcy to reduce noise
        const originalLog = console.log;
        console.log = function(...args) {
          // Filter out repetitive Transcy logs
          if (args[0] && typeof args[0] === 'string' && args[0].includes('arrSwitcherOld')) {
            return; // Skip this log
          }
          originalLog.apply(console, args);
        };
      };
      
      // Initialize optimizations when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', window.optimizeTranscy);
      } else {
        window.optimizeTranscy();
      }
      
      // Fix HotReload CLI warning by setting proper configuration
      if (typeof window !== 'undefined') {
        window.hotReloadPort = window.hotReloadPort || 9292;
        window.hotReloadEnabled = true;
      }
    </script>
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "rkvo18a1yq");
  </script>

<!-- Slick Slider CDN -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>


  </head>

  <body class=" {{template.name}} gradient link-btns--{{ settings.link_btn_hover }} action-btns--{{ settings.action_btn_hover }} omx-hide-appstle"{% if is_rtl %} data-rtl="true"{% endif %}>
    <a class="skip-to-content-link button visually-hidden" href="#MainContent">
      {{ 'accessibility.skip_to_text' | t }}
    </a>

    {% sections 'header-group' %}
    
    {%- if settings.cart_type == 'drawer' -%}
      {%- section 'cart-drawer' -%}
    {%- endif -%}

    <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
      {{ content_for_layout }}
    </main>

    {% section 'promo-popup' %}
    {% section 'scroll-to-top-btn' %}
    {% section 'global-music-player' %}
    {% sections 'footer-group' %}
    {% comment %} {% section 'recently-purchase' %} {% endcomment %}

    <ul hidden>
      <li id="a11y-refresh-page-message">{{ 'accessibility.refresh_page' | t }}</li>
      <li id="a11y-new-window-message">{{ 'accessibility.link_messages.new_window' | t }}</li>
    </ul>

    <script>
      window.shopUrl = '{{ request.origin }}';
      window.routes = {
        cart_add_url: '{{ routes.cart_add_url }}',
        cart_change_url: '{{ routes.cart_change_url }}',
        cart_update_url: '{{ routes.cart_update_url }}',
        cart_clear_url: '{{ routes.cart_clear_url }}',
        cart_url: '{{ routes.cart_url }}',
        predictive_search_url: '{{ routes.predictive_search_url }}'
      };

      window.cartStrings = {
        error: `{{ 'sections.cart.cart_error' | t }}`,
        quantityError: `{{ 'sections.cart.cart_quantity_error_html' | t: quantity: '[quantity]' }}`
      }

      window.variantStrings = {
        addToCart: `{{ 'products.product.add_to_cart' | t }}`,
        soldOut: `{{ 'products.product.sold_out' | t }}`,
        unavailable: `{{ 'products.product.unavailable' | t }}`,
        unavailable_with_option: `{{ 'products.product.value_unavailable' | t: option_value: '[value]' }}`,
      }

      window.accessibilityStrings = {
        imageAvailable: `{{ 'products.product.media.image_available' | t: index: '[index]' }}`,
        shareSuccess: `{{ 'general.share.success_message' | t }}`,
        pauseSlideshow: `{{ 'sections.slideshow.pause_slideshow' | t }}`,
        playSlideshow: `{{ 'sections.slideshow.play_slideshow' | t }}`,
      }
    </script>

    <script>
      const productForm = document.querySelector('product-form[data-main="true"]');
      if (productForm) {
        document.querySelectorAll('[id^="SectionAtcBtn-"]').forEach(btn => {
          btn.addEventListener('click', (e) => {
            productForm.handleSubmit(e);
          })
        })
      }

      {% if settings.enable_load_animations %}
        const stickyAtc = document.querySelector('.sticky-atc');
        let bottomMargin = 50;
        if (stickyAtc) bottomMargin += stickyAtc.clientHeight;
        const shrineAnimationsObserver = new IntersectionObserver(elements => {
          elements.forEach(element => {
            if (element.isIntersecting) {
              element.target.classList.add('animate--shown');
            } 
            {% if settings.repeat_section_animations %}
              else {
                element.target.classList.remove('animate--shown');
              }
            {% endif %}
          })
        },  { rootMargin: `0px 0px -${bottomMargin}px 0px` })

        function initAnimations(rootElement = document, isThemeEditorEvent = false) {
          const elementsToAnimate = rootElement.querySelectorAll('.animate-section');
          if (elementsToAnimate.length == 0) return;

          
          elementsToAnimate.forEach(element => {
            if (isThemeEditorEvent) {
              element.classList.add('animate--shown');
              return;
            } 
            shrineAnimationsObserver.observe(element);
          })
        }

        window.addEventListener('DOMContentLoaded', () => initAnimations());
        if (Shopify.designMode) {
          document.addEventListener('shopify:section:load', (event) => initAnimations(event.target, true));
          document.addEventListener('shopify:section:reorder', () => initAnimations(document, true));
        }
      {% endif %}
    </script>

    <script>
      (function () {
        var links = document.links;
        for (let i = 0; i < links.length;  i++) {
          if (links[i].hostname !== window.location.hostname) {
            links[i].target = '_blank';
            links[i].rel = 'noreferrer noopener';
          }
        }
      })();
    </script>

    {% if settings.disable_inspect %}
      <script>
        window.addEventListener("contextmenu", (e) => {
          e.preventDefault();
        });
        document.addEventListener("selectstart", (e) => {
          e.preventDefault();
        });
        document.addEventListener('DOMContentLoaded', function() {
          document.querySelectorAll('img').forEach(img => {
            img.addEventListener('dragstart', function(e) {
              e.preventDefault();
            })
          })
        })
        function ctrlShiftKey(e, keyCode) {
          return e.ctrlKey && e.shiftKey && e.keyCode === keyCode.charCodeAt(0);
        }
        document.addEventListener('keydown', function(e) {
          if (
            event.keyCode === 123 ||
            ctrlShiftKey(e, 'I') ||
            ctrlShiftKey(e, 'J') ||
            ctrlShiftKey(e, 'C') ||
            (e.ctrlKey && e.keyCode === 'U'.charCodeAt(0))
          ) {
            e.preventDefault();
          }
        })
      </script>
    {% endif %}
    {% if settings.display_store_languages %}
      {% render 'enabled-languages-modal' %}
    {% endif %}

{% if settings.enable_upsell %}   
{% if settings.upsell_product != blank %}
<style>
  button#addSleepTightBtn.active span.main-atc__label__text {
    display: none;
  }
 button#addSleepTightBtn.active .loading-overlay__spinner.hidden {
    display: inline-block !important;
  }
.upsell-overlay {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 9999;
  width: 100vw;
  height: 100vh;
  background: #fff;
  display: none;
  justify-content: center;
  align-items: center;
  padding: 2rem;
}
.upsell-overlay.active {
 display: flex;
}
.upsell-hero {
    color: white;
    text-align: center;
    width: 100%;
    max-width: 800px;
    margin: auto;
    display: flex;
    align-items: center;
    grid-gap: 20px;
    background: #fff;
}
.upsell_image {
    width: 50%;
}
.upsell-message h1 {
  font-size: 3rem;
  margin-bottom: 1rem;
  font-weight: 800;
}
.upsell-message {
    width: 50%;
}
.upsell-message p {
    font-size: 1.25rem;
    margin-bottom: 2rem;
    color: #000;
}
.upsell-buttons {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 20px;
}

.upsell-buttons button {
  padding: 0.75rem 2rem;
  font-size: 16px;
  cursor: pointer;
  border: none;
  border-radius: 6px;
  transition: background 0.3s ease;
}

#addSleepTightBtn {
  font-weight: bold;
  width: 100%;
}
button#dismissUpsellBtn {
    color: gray;
}
#dismissUpsellBtn {
  background-color: transparent;
}
@media screen and (max-width: 750px) {
  .upsell-hero {
    flex-wrap: wrap;
}
  .upsell-message {
    width: 100%;
}
  .upsell_image {
    width: 49%;
    margin: 0 auto;
}
  .upsell-overlay {
    padding: 1rem;
    background: #fff;
  }
}
</style>  
{% assign upsell_product = settings.upsell_product %}
<div class="upsell-overlay" id="upsellOverlay">
  <div class="upsell-hero">
    <div class="upsell_image">
      {% if settings.upsell_image != blank %}
        {{ settings.upsell_image | image_url: width: 800 | image_tag: loading: 'lazy', alt: upsell_product.title | escape }}
        {% else %}
        {{ upsell_product.featured_image | image_url: width: 800 | image_tag: loading: 'lazy', alt: upsell_product.title | escape }}
      {% endif %}
    </div>
    <div class="upsell-message">
      <h2>{{ upsell_product.title }}</h2>
      <h3>{{ settings.upsell_title }}</h3>
      <div class="rte">
        {{ settings.upsell_description }}
      </div>
      <div class="upsell-buttons">
        <button id="addSleepTightBtn" class="button mb-1em button--primary">
          
        <span class="main-atc__label__text">
         {{ settings.add_btn }}
        </span>
        <div class="loading-overlay__spinner hidden">
                <svg aria-hidden="true" focusable="false" class="spinner" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
                  <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                </svg>
              </div>
        </button>
        <button id="dismissUpsellBtn" class="btn mb-1em button--secondary"> {{ settings.decline_btn }}</button>
      </div>
    </div>
  </div>
</div>

{% if product.id != 10597569921355 %}
<script>
  $(document).ready(function () {
    const sleepTightVariantId = '51745662468427'; // Your upsell variant ID
    let upsellShown = false;
    let originalClickTarget = null;

    // Delegated handler for ATC button
    $(document).on('click', '.atc-button, .main-product-atc', function (e) {
      // Only intercept the first time
      if (!upsellShown) {
        e.preventDefault();
        originalClickTarget = $(this); // Store which button was clicked
        $('#upsellOverlay').addClass('active');
        upsellShown = true;
      }
    });

    // Add Sleep Tight to cart and continue
    $('#addSleepTightBtn').click(function () {
      $('button#addSleepTightBtn').addClass('active');
      fetch('/cart/add.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          quantity: 1,
          id: sleepTightVariantId
        })
      }).then(() => {
        $('#upsellOverlay').removeClass('active');
        // Re-trigger the stored original ATC click
        if (originalClickTarget && originalClickTarget.length) {
          originalClickTarget.trigger('click');
        } else {
          // fallback: trigger first available ATC
          $('.atc-button, .main-product-atc').first().trigger('click');
        }
      });
    });

    // Skip upsell and continue to ATC
    $('#dismissUpsellBtn').click(function () {
      $('#upsellOverlay').removeClass('active');
      if (originalClickTarget && originalClickTarget.length) {
        originalClickTarget.trigger('click');
      } else {
        $('.atc-button, .main-product-atc').first().trigger('click');
      }
    });
  });
 
  const rtlCheckInterval = setInterval(() => {
    const htmlEl = document.documentElement;

    if (htmlEl.classList.contains('translated-rtl') && htmlEl.getAttribute('dir') !== 'rtl') {
      htmlEl.setAttribute('dir', 'rtl');
      clearInterval(rtlCheckInterval); // Stop checking once applied
    }
  }, 500); // Check every 500ms

</script>   
{% endif %}
{% endif %}
{% endif %}
<style>
  html[dir="rtl"] .chevron-left {
  transform: rotate(180deg);
}
html[dir="rtl"] .chevron-right {
  transform: rotate(180deg);
}
html[dir="rtl"] .rtl-mirror {
  transform: scaleX(-1);
}
</style>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const orderElement = document.querySelector('.review-avatars__text strong');

    if (!orderElement) return;

    // Starting and ending values
    let currentOrders = 5;
    const maxOrders = 50;

    // Display the initial number
    orderElement.textContent = currentOrders + ' orders';

    // Function to increase the number
    const increaseOrders = () => {
      if (currentOrders < maxOrders) {
        // Random small increase between 1 and 3
        const increase = Math.floor(Math.random() * 3) + 1;
        currentOrders = Math.min(currentOrders + increase, maxOrders);
        orderElement.textContent = currentOrders + ' orders';
      }
    };

    // Increase every 20 minutes (20 * 60 * 1000 ms)
    const intervalTime = 20 * 60 * 1000;
    setInterval(increaseOrders, intervalTime);
  });
</script>


 {% comment %} <script>
  document.addEventListener("DOMContentLoaded", function () {
    // Check if current page URL contains '/cart'
    if (window.location.pathname.includes("/cart")) {
      // Wait for the checkout button to load
      const checkButton = () => {
        const checkoutBtn = document.querySelector("#checkout");
        if (checkoutBtn) {
          checkoutBtn.click(); // Trigger click
          console.log("âœ… Checkout button auto-clicked");
        } else {
          // Try again after a short delay (Shopify sometimes loads it asynchronously)
          setTimeout(checkButton, 10);
        }
      };

      checkButton();
    }
  });
</script>  {% endcomment %}

{% comment %} 
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Select the Add to Cart button
  const addToCartBtn = document.querySelector('.new-btn.atc-button.product-form__submit');
  if (addToCartBtn) {
    addToCartBtn.addEventListener('click', function() {
      // Wait a short moment for Shopify's Add to Cart process to complete
   //debugger;
        window.location.href = '/checkout';
    // Adjust delay (ms) if needed
    });
  }
});
</script> {% endcomment %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const cards = document.querySelectorAll("#subscription-card");

    cards.forEach(card => {
      card.addEventListener("click", function() {
        const label = card.querySelector("label");
        if (label) {
          label.click(); // trigger click on label
        }
      });
    });
  });
</script>


{% comment %} <script>
document.addEventListener("DOMContentLoaded", function() {
  // Find the main product form dynamically
  const form = document.querySelector('form[action^="/cart/add"]');
  const subscriptionRoot = document.querySelector('#omx-subscription-root');

  if (!form || !subscriptionRoot) return;

  // Try reading selling plan info dynamically from data attribute
  let planId = null;
  try {
    const groups = JSON.parse(subscriptionRoot.dataset.spGroupsJson || '[]');
    if (groups.length && groups[0].selling_plans && groups[0].selling_plans.length) {
      planId = groups[0].selling_plans[0].id;
    }
  } catch (e) {
    console.warn("Unable to parse selling plan data", e);
  }

  if (!planId) {
    console.warn("âš ï¸ No selling plan found on this product");
    return;
  }

  // Function to add or update hidden selling_plan input
  function ensureSubscription() {
    let planInput = form.querySelector('input[name="selling_plan"]');
    if (!planInput) {
      planInput = document.createElement("input");
      planInput.type = "hidden";
      planInput.name = "selling_plan";
      form.appendChild(planInput);
    }
    planInput.value = planId;
  }

  // Always enforce subscription plan
  ensureSubscription();

  // Reapply before submission
  form.addEventListener("submit", ensureSubscription);

  // Optional: disable "One Time Purchase" card visually + prevent clicks
  const oneTimeCard = document.querySelector('#one-time-card');
  if (oneTimeCard) {
    oneTimeCard.style.opacity = "0.5";
    oneTimeCard.style.pointerEvents = "none";
    oneTimeCard.style.userSelect = "none";
  }

  console.log("âœ… Subscription enforced with plan ID:", planId);
});
</script> {% endcomment %}

 <script>
document.addEventListener('DOMContentLoaded', function() {
  const stickyAtcBtn = document.querySelector('.sticky-atc__button');
  const subscriptionBtn = document.querySelector('.main-product-atc.new-btn');

  if (stickyAtcBtn && subscriptionBtn) {
    stickyAtcBtn.addEventListener('click', function(e) {
      e.preventDefault();
      subscriptionBtn.click();
    });
  }
});
</script> 

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){

  // ðŸ”¹ Function to detect price locations safely
  function getSelectedData() {
    let selectedType = $('input[name="purchase_type"]:checked').val();
    let salePrice = '';
    let comparePrice = '';
    let badgeText = '';

    if (selectedType === 'subscription') {
      // Sale price (discounted)
      salePrice = $('#subscription-price-display').text().trim();

      // Fallback: find any visible .transcy-money (e.g. $31.2)
      if (!salePrice) {
        salePrice = $('#subscription-card .transcy-money.notranslate:visible').first().text().trim();
      }

      // âœ… FIXED: Reset compare price when switching to subscription
      comparePrice = $('#subscription-card .transcy-money[style*="line-through"]').text().trim() || '';

      // Fallback: if not found, clear it completely
      if (!comparePrice) comparePrice = '';

      badgeText = $('#subscription-card .modern-badge').text().trim();

    } else if (selectedType === 'one-time') {
      // Regular one-time purchase
      salePrice = $('#one-time-card .transcy-money.notranslate').first().text().trim();

      // Optional compare (if shown via line-through in one-time card)
      comparePrice = $('#one-time-card .transcy-money[style*="line-through"]').first().text().trim();

      badgeText = '';
    }

    return { salePrice, comparePrice, badgeText };
  }

  // ðŸ”¹ Update sticky ATC section
  function updateStickyATC() {
    const { salePrice, comparePrice, badgeText } = getSelectedData();

    const $sticky = $('.sticky-atc');
    const $sale = $sticky.find('.price-item--sale tc-money');
    const $regular = $sticky.find('.price-item--regular tc-money');
    const $compare = $sticky.find('.price__compare-price s tc-money');
    const $badge = $sticky.find('.price__badge-sale .nowrap');

    // --- Update sale + regular price ---
    if (salePrice) {
      $sale.text(salePrice);
      $regular.text(salePrice);
    }

    // --- Update compare (crossed out) price ---
    if (comparePrice) {
      $compare.text(comparePrice);
      $compare.closest('.price__compare-price').show();
    } else {
      $compare.text('');
      $compare.closest('.price__compare-price').hide();
    }

    // --- Update badge text ---
    if (badgeText) {
      $badge.text(badgeText.replace(/more/i, '').trim());
      $badge.closest('.price__badge-sale').show();
    } else {
      $badge.closest('.price__badge-sale').hide();
    }

    console.log("âœ… Sticky updated â†’ Sale:", salePrice, "| Compare:", comparePrice, "| Badge:", badgeText);
  }

  // --- Run on page load ---
  updateStickyATC();

  // --- Run when user toggles purchase type ---
  $('input[name="purchase_type"]').on('change', function(){
    updateStickyATC();
  });

  // --- Run when one-time "Supply" buttons clicked ---
  $('.supply-selector .modern-btn').on('click', function(){
    $('.modern-btn').removeClass('active').addClass('inactive');
    $(this).addClass('active').removeClass('inactive');
    const newPrice = $(this).data('price');
    $('#one-time-card .transcy-money.notranslate').first().text(`$${newPrice}`);
    updateStickyATC();
  });

});
</script>


<style>
/* Expanded state */
.review-avatars.expanded .review-avatars__avatar {
    transform: translateX(0) !important;
    margin-right: 14px;
    transition: all 0.3s ease;
}

/* Default overlapped state (optional if your theme already handles this) */
.review-avatars__avatar {
    transition: all 0.3s ease;
}
</style>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const avatarContainer = document.querySelector(".review-avatars");

    if (!avatarContainer) return;

    avatarContainer.addEventListener("click", function () {
        // Add expanded class
        avatarContainer.classList.add("expanded");

        // Remove after 1 second
        setTimeout(() => {
            avatarContainer.classList.remove("expanded");
        }, 1000);
    });
});


</script>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>



<style>
  .index .card-slider__grid {

  grid-template-columns: repeat(2, 1fr)!important;

}

@media screen and (min-width: 768px) {
     .index .card-slider__card-image {
        height: 100%;
    }
}

</style>
  <!-- === START: INTELLIGENT SCRIPT LOADER === -->
  <script>
  (function() {
    'use strict';
    
    // ===== CONFIGURATION =====
    const loadConfig = {
      // When to load different script types
      timing: {
        analytics: 'loaded',      // After page load
        reviews: 'visible',       // When element is visible
        chat: 'interaction',      // On user interaction
        ads: 'scroll',           // After scrolling
        social: 'hover'          // On hover
      },
      
      // Priority thresholds
      thresholds: {
        scroll: 300,            // Load ads after 300px scroll
        timeout: 5000,          // Load all after 5 seconds (fallback)
        visibleMargin: '100px'  // Load when within 100px of viewport
      }
    };
    
    // ===== LOADING FUNCTIONS =====
    class ScriptLoader {
      constructor() {
        this.loadedCategories = new Set();
        this.userInteracted = false;
        this.init();
      }
      
      init() {
        this.setupObservers();
        this.setupEventListeners();
        this.startLoadingSequence();
      }
      
      setupObservers() {
        // Intersection Observer for visible elements
        this.intersectionObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const element = entry.target;
              const category = element.getAttribute('data-load-category');
              if (category && !this.loadedCategories.has(category)) {
                this.loadCategory(category);
              }
            }
          });
        }, {
          rootMargin: loadConfig.thresholds.visibleMargin,
          threshold: 0.1
        });
        
        // Observe elements that trigger script loading
        document.querySelectorAll('[data-trigger-scripts]').forEach(el => {
          this.intersectionObserver.observe(el);
        });
      }
      
      setupEventListeners() {
        // User interaction events
        const interactionEvents = ['click', 'touchstart', 'keydown', 'mousemove'];
        interactionEvents.forEach(event => {
          window.addEventListener(event, () => {
            this.userInteracted = true;
            this.loadCategory('chat');
            this.loadCategory('social');
          }, { once: true, passive: true });
        });
        
        // Scroll events
        window.addEventListener('scroll', () => {
          if (window.scrollY > loadConfig.thresholds.scroll) {
            this.loadCategory('ads');
          }
        }, { passive: true });
        
        // Hover events for social
        document.addEventListener('mouseover', (e) => {
          if (e.target.closest('[class*="share"], [class*="social"]')) {
            this.loadCategory('social');
          }
        });
        
        // Page load event
        window.addEventListener('load', () => {
          setTimeout(() => this.loadCategory('analytics'), 1000);
        });
        
        // Fallback: Load everything after timeout
        setTimeout(() => {
          this.loadAllRemaining();
        }, loadConfig.thresholds.timeout);
      }
      
      startLoadingSequence() {
        // Load essential scripts immediately
        this.loadEssentialScripts();
        
        // Setup triggers based on page type
        this.setupPageSpecificTriggers();
      }
      
      loadEssentialScripts() {
        // These scripts load immediately (not blocked)
        const essentials = [
          // Add any essential scripts that bypassed the blocker
        ];
        
        essentials.forEach(src => {
          this.injectScript(src, 'essential');
        });
      }
      
      loadCategory(category) {
        if (this.loadedCategories.has(category)) return;
        
        this.loadedCategories.add(category);
        const queue = window.thirdPartyQueue[category] || [];
        
        console.log(`ðŸ“¦ Loading ${category} scripts (${queue.length} total)`);
        
        queue.forEach(scriptData => {
          if (!scriptData.loaded) {
            this.injectScript(scriptData.src, category, scriptData.attributes);
            scriptData.loaded = true;
          }
        });
      }
      
      loadAllRemaining() {
        Object.keys(window.thirdPartyQueue).forEach(category => {
          this.loadCategory(category);
        });
      }
      
      injectScript(src, category, attributes = {}) {
        return new Promise((resolve) => {
          if (document.querySelector(`script[src*="${this.extractDomain(src)}"]`)) {
            console.log(`âš ï¸ ${category} script already loaded:`, src);
            resolve();
            return;
          }
          
          console.log(`ðŸš€ Injecting ${category} script:`, src);
          
          const script = document.createElement('script');
          script.src = src;
          script.async = true;
          
          // Copy attributes
          Object.keys(attributes).forEach(key => {
            if (key !== 'src' && key !== 'async' && key !== 'defer') {
              script.setAttribute(key, attributes[key]);
            }
          });
          
          // Add tracking attributes
          script.setAttribute('data-loaded-by', 'script-loader');
          script.setAttribute('data-category', category);
          script.setAttribute('data-loaded-at', Date.now());
          
          script.onload = () => {
            console.log(`âœ… ${category} script loaded:`, src);
            resolve();
          };
          
          script.onerror = () => {
            console.warn(`âŒ Failed to load ${category} script:`, src);
            resolve();
          };
          
          document.head.appendChild(script);
        });
      }
      
      extractDomain(url) {
        try {
          return new URL(url).hostname;
        } catch {
          return url.split('/')[2] || url;
        }
      }
      
      setupPageSpecificTriggers() {
        // Product page triggers
        if (document.querySelector('.product-single')) {
          // Load reviews when product is visible
          const productElement = document.querySelector('[data-product]') || 
                                document.querySelector('.product-single');
          if (productElement) {
            productElement.setAttribute('data-trigger-scripts', 'reviews');
            this.intersectionObserver.observe(productElement);
          }
        }
        
        // Cart page triggers
        if (document.querySelector('.cart') || document.querySelector('[name="cart"]')) {
          this.loadCategory('ads'); // Load retargeting on cart page
        }
        
        // Checkout page
        if (window.location.pathname.includes('/checkout')) {
          // Load all analytics on checkout
          setTimeout(() => {
            this.loadCategory('analytics');
            this.loadCategory('ads');
          }, 500);
        }
      }
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        window.scriptLoader = new ScriptLoader();
      });
    } else {
      window.scriptLoader = new ScriptLoader();
    }
    
    // ===== UTILITY FUNCTIONS =====
    // Manually trigger script loading from console or other scripts
    window.loadThirdPartyScripts = function(category) {
      if (window.scriptLoader) {
        if (category) {
          window.scriptLoader.loadCategory(category);
        } else {
          window.scriptLoader.loadAllRemaining();
        }
      }
    };
    
    // Force load specific script (emergency)
    window.loadScriptNow = function(src) {
      const script = document.createElement('script');
      script.src = src;
      script.async = true;
      document.head.appendChild(script);
      console.log('ðŸš¨ Force-loaded script:', src);
    };
    
  })();
  </script>
  <!-- === END: INTELLIGENT SCRIPT LOADER === -->

  {% comment %} Add this to show loading status {% endcomment %}
<style>
  .script-loader-status {
    position: fixed;
    bottom: 10px;
    right: 10px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 10px;
    border-radius: 5px;
    font-size: 12px;
    z-index: 99999;
    display: none;
  }
  .script-loader-status.visible {
    display: block;
  }
  .script-loader-status .category {
    margin: 2px 0;
    padding: 2px 5px;
    border-radius: 3px;
  }
  .script-loader-status .loaded {
    background: #4CAF50;
  }
  .script-loader-status .pending {
    background: #FF9800;
  }
</style>

<div class="script-loader-status" id="loaderStatus">
  <div>Script Loader Status:</div>
  <div class="category pending" data-category="analytics">Analytics: Pending</div>
  <div class="category pending" data-category="reviews">Reviews: Pending</div>
  <div class="category pending" data-category="chat">Chat: Pending</div>
  <div class="category pending" data-category="ads">Ads: Pending</div>
</div>

<script>
// Update visual status
document.addEventListener('DOMContentLoaded', function() {
  const statusEl = document.getElementById('loaderStatus');
  
  if (window.scriptLoader) {
    // Show status in development
    if (window.location.hostname.includes('myshopify.com') || 
        window.location.search.includes('debug=scripts')) {
      statusEl.classList.add('visible');
    }
    
    // Update status when categories load
    const observer = {
      loadedCategories: new Set(),
      update: function(category) {
        this.loadedCategories.add(category);
        const el = statusEl.querySelector(`[data-category="${category}"]`);
        if (el) {
          el.classList.remove('pending');
          el.classList.add('loaded');
          el.textContent = `${category.charAt(0).toUpperCase() + category.slice(1)}: Loaded`;
        }
        
        // Hide when all loaded
        if (this.loadedCategories.size >= 4) {
          setTimeout(() => {
            statusEl.classList.remove('visible');
          }, 2000);
        }
      }
    };
    
    // Override loadCategory to update UI
    const originalLoad = window.scriptLoader.loadCategory;
    window.scriptLoader.loadCategory = function(category) {
      originalLoad.call(this, category);
      observer.update(category);
    };
  }
});
</script>
  </body>
</html>
